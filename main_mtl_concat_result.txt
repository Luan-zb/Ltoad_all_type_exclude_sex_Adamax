(toad) daichuangchuang@DELLW01:~/Nature/Ltoad_exclude_sex$ CUDA_VISIBLE_DEVICES=0 python main_mtl_concat_LSCC_CCRCC_CM.py --drop_out --early_stopping --lr 2e-4 --k 1 --exp_code dummy_mtl_sex  --task dummy_mtl_concat  --log_data --data_root_dir /home/daichuangchuang/Nature/CLAM/data_root_dir

Load Dataset
task:  0
label column: label
label dictionary: {'Lung': 0, 'Skin': 1, 'Kidney': 2}
number of classes: 3
slide-level counts:
 0    681
1    284
2    505
Name: label, dtype: int64
Patient-LVL; Number of samples registered in class 0: 210
Slide-LVL; Number of samples registered in class 0: 681
Patient-LVL; Number of samples registered in class 1: 93
Slide-LVL; Number of samples registered in class 1: 284
Patient-LVL; Number of samples registered in class 2: 216
Slide-LVL; Number of samples registered in class 2: 505
################# Settings ###################
num_splits:  1
k_start:  -1
k_end:  -1
task:  dummy_mtl_concat
max_epochs:  200
results_dir:  ./results
lr:  0.0002
experiment:  dummy_mtl_sex
reg:  1e-05
seed:  1
use_drop_out:  True
weighted_sample:  False
opt:  adam
split_dir:  splits_LSCC_CM_CCRCC/dummy_mtl_concat_100
training: 1314, validation: 52, testing: 104

Training Fold 0!

Init train/val/test splits... Done!
Training on 1314 samples
Validating on 52 samples
Testing on 104 samples

Init Model... Done!
TOAD_fc_mtl_concat(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Linear(in_features=512, out_features=512, bias=True)
    (4): ReLU()
    (5): Dropout(p=0.25, inplace=False)
    (6): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=384, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=384, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=384, out_features=1, bias=True)
    )
  )
  (classifier): Linear(in_features=512, out_features=3, bias=True)
)
Total number of parameters: 1183364
Total number of trainable parameters: 1183364

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 4, cls loss: 1.0414, label: 0,  bag_size: 5237
batch 9, cls loss: 1.2882, label: 2,  bag_size: 12703
batch 14, cls loss: 1.0959, label: 1,  bag_size: 9535
batch 19, cls loss: 1.0350, label: 0,  bag_size: 9065
batch 24, cls loss: 1.0399, label: 0,  bag_size: 1015
batch 29, cls loss: 1.2164, label: 1,  bag_size: 2813
batch 34, cls loss: 0.8772, label: 0,  bag_size: 6736
batch 39, cls loss: 1.3283, label: 2,  bag_size: 1166
batch 44, cls loss: 1.3392, label: 2,  bag_size: 2219
batch 49, cls loss: 1.2834, label: 1,  bag_size: 12167
batch 54, cls loss: 1.2790, label: 2,  bag_size: 2825
batch 59, cls loss: 1.2564, label: 1,  bag_size: 7163
batch 64, cls loss: 1.0893, label: 2,  bag_size: 5756
batch 69, cls loss: 1.4708, label: 1,  bag_size: 834
batch 74, cls loss: 1.0391, label: 0,  bag_size: 2759
batch 79, cls loss: 1.5187, label: 1,  bag_size: 3690
batch 84, cls loss: 0.9508, label: 0,  bag_size: 5163
batch 89, cls loss: 1.4477, label: 1,  bag_size: 16743
batch 94, cls loss: 1.3680, label: 1,  bag_size: 3458
batch 99, cls loss: 0.8988, label: 0,  bag_size: 10028
batch 104, cls loss: 1.1772, label: 2,  bag_size: 7216
batch 109, cls loss: 1.0921, label: 2,  bag_size: 3098
batch 114, cls loss: 1.3192, label: 1,  bag_size: 12192
batch 119, cls loss: 1.2557, label: 2,  bag_size: 4344
batch 124, cls loss: 0.7049, label: 0,  bag_size: 7981
batch 129, cls loss: 0.6523, label: 0,  bag_size: 5308
batch 134, cls loss: 0.5971, label: 0,  bag_size: 4442
batch 139, cls loss: 2.1181, label: 1,  bag_size: 1102
batch 144, cls loss: 0.5200, label: 0,  bag_size: 6239
batch 149, cls loss: 2.4126, label: 1,  bag_size: 3609
batch 154, cls loss: 0.8454, label: 2,  bag_size: 3203
batch 159, cls loss: 0.7925, label: 0,  bag_size: 6781
batch 164, cls loss: 0.7717, label: 0,  bag_size: 9215
batch 169, cls loss: 1.7047, label: 1,  bag_size: 714
batch 174, cls loss: 0.6288, label: 0,  bag_size: 11266
batch 179, cls loss: 1.5132, label: 1,  bag_size: 1664
batch 184, cls loss: 0.5219, label: 0,  bag_size: 14433
batch 189, cls loss: 0.4213, label: 0,  bag_size: 1753
batch 194, cls loss: 0.5517, label: 0,  bag_size: 1064
batch 199, cls loss: 0.5634, label: 0,  bag_size: 2966
batch 204, cls loss: 0.6811, label: 0,  bag_size: 3576
batch 209, cls loss: 1.8240, label: 1,  bag_size: 1941
batch 214, cls loss: 0.5930, label: 0,  bag_size: 10169
batch 219, cls loss: 1.7401, label: 1,  bag_size: 6311
batch 224, cls loss: 1.5870, label: 1,  bag_size: 3110
batch 229, cls loss: 1.7708, label: 1,  bag_size: 1612
batch 234, cls loss: 0.3427, label: 2,  bag_size: 2065
batch 239, cls loss: 0.9055, label: 0,  bag_size: 11875
batch 244, cls loss: 1.1700, label: 1,  bag_size: 12107
batch 249, cls loss: 0.6618, label: 0,  bag_size: 6016
batch 254, cls loss: 0.4717, label: 0,  bag_size: 18468
batch 259, cls loss: 0.5287, label: 0,  bag_size: 19439
batch 264, cls loss: 0.3217, label: 0,  bag_size: 1657
batch 269, cls loss: 1.6936, label: 1,  bag_size: 5739
batch 274, cls loss: 0.8674, label: 2,  bag_size: 5303
batch 279, cls loss: 0.2712, label: 2,  bag_size: 2629
batch 284, cls loss: 0.3282, label: 2,  bag_size: 7082
batch 289, cls loss: 0.8748, label: 0,  bag_size: 11964
batch 294, cls loss: 0.4030, label: 0,  bag_size: 2936
batch 299, cls loss: 0.3828, label: 0,  bag_size: 9393
batch 304, cls loss: 0.1915, label: 0,  bag_size: 9610
batch 309, cls loss: 1.9583, label: 1,  bag_size: 2511
batch 314, cls loss: 0.3699, label: 2,  bag_size: 3124
batch 319, cls loss: 0.1169, label: 2,  bag_size: 1322
batch 324, cls loss: 0.5714, label: 2,  bag_size: 2819
batch 329, cls loss: 0.3214, label: 0,  bag_size: 20767
batch 334, cls loss: 0.2450, label: 2,  bag_size: 2709
batch 339, cls loss: 0.2014, label: 0,  bag_size: 12408
batch 344, cls loss: 2.2078, label: 1,  bag_size: 1082
batch 349, cls loss: 1.7110, label: 2,  bag_size: 8653
batch 354, cls loss: 0.4732, label: 0,  bag_size: 1867
batch 359, cls loss: 0.6626, label: 0,  bag_size: 16703
batch 364, cls loss: 0.0287, label: 2,  bag_size: 4442
batch 369, cls loss: 1.8810, label: 1,  bag_size: 13121
batch 374, cls loss: 0.2487, label: 2,  bag_size: 14572
batch 379, cls loss: 1.5408, label: 1,  bag_size: 881
batch 384, cls loss: 0.2365, label: 0,  bag_size: 4120
batch 389, cls loss: 0.2076, label: 0,  bag_size: 13791
batch 394, cls loss: 1.3123, label: 1,  bag_size: 7248
batch 399, cls loss: 1.5281, label: 2,  bag_size: 7917
batch 404, cls loss: 1.5724, label: 1,  bag_size: 26724
batch 409, cls loss: 1.6271, label: 1,  bag_size: 2620
batch 414, cls loss: 0.5669, label: 0,  bag_size: 5516
batch 419, cls loss: 0.3415, label: 0,  bag_size: 4959
batch 424, cls loss: 1.1499, label: 1,  bag_size: 8254
batch 429, cls loss: 0.1515, label: 2,  bag_size: 6045
batch 434, cls loss: 0.4747, label: 0,  bag_size: 4039
batch 439, cls loss: 0.0518, label: 2,  bag_size: 2335
batch 444, cls loss: 0.1139, label: 2,  bag_size: 2078
batch 449, cls loss: 0.2836, label: 2,  bag_size: 5664
batch 454, cls loss: 0.9738, label: 1,  bag_size: 8759
batch 459, cls loss: 0.6813, label: 1,  bag_size: 2403
batch 464, cls loss: 0.5338, label: 0,  bag_size: 16512
batch 469, cls loss: 0.8821, label: 1,  bag_size: 4811
batch 474, cls loss: 1.1921, label: 1,  bag_size: 1612
batch 479, cls loss: 1.1460, label: 1,  bag_size: 15582
batch 484, cls loss: 0.3603, label: 2,  bag_size: 2068
batch 489, cls loss: 0.5602, label: 1,  bag_size: 3473
batch 494, cls loss: 1.1023, label: 0,  bag_size: 4786
batch 499, cls loss: 0.3050, label: 2,  bag_size: 12594
batch 504, cls loss: 0.3215, label: 0,  bag_size: 6792
batch 509, cls loss: 0.1361, label: 2,  bag_size: 4358
batch 514, cls loss: 0.8161, label: 0,  bag_size: 7246
batch 519, cls loss: 0.7993, label: 0,  bag_size: 1746
batch 524, cls loss: 1.6691, label: 1,  bag_size: 9173
batch 529, cls loss: 0.2871, label: 0,  bag_size: 1776
batch 534, cls loss: 0.2459, label: 0,  bag_size: 15931
batch 539, cls loss: 0.2196, label: 2,  bag_size: 1690
batch 544, cls loss: 0.1186, label: 2,  bag_size: 3655
batch 549, cls loss: 0.2017, label: 2,  bag_size: 8383
batch 554, cls loss: 0.0502, label: 2,  bag_size: 2263
batch 559, cls loss: 0.9180, label: 1,  bag_size: 5505
batch 564, cls loss: 0.2919, label: 2,  bag_size: 13622
batch 569, cls loss: 0.4011, label: 0,  bag_size: 10432
batch 574, cls loss: 1.1149, label: 1,  bag_size: 5727
batch 579, cls loss: 0.0643, label: 2,  bag_size: 4419
batch 584, cls loss: 0.3965, label: 0,  bag_size: 5690
batch 589, cls loss: 0.3707, label: 0,  bag_size: 8012
batch 594, cls loss: 0.0305, label: 2,  bag_size: 3781
batch 599, cls loss: 0.9071, label: 1,  bag_size: 3541
batch 604, cls loss: 0.2250, label: 0,  bag_size: 11884
batch 609, cls loss: 0.1580, label: 0,  bag_size: 1412
batch 614, cls loss: 3.1368, label: 2,  bag_size: 7810
batch 619, cls loss: 1.4561, label: 2,  bag_size: 4443
batch 624, cls loss: 0.4855, label: 1,  bag_size: 5316
batch 629, cls loss: 0.8989, label: 1,  bag_size: 5576
batch 634, cls loss: 0.0273, label: 2,  bag_size: 10345
batch 639, cls loss: 0.3989, label: 0,  bag_size: 7110
batch 644, cls loss: 0.2324, label: 0,  bag_size: 11394
batch 649, cls loss: 0.0858, label: 0,  bag_size: 5561
batch 654, cls loss: 0.2484, label: 0,  bag_size: 3879
batch 659, cls loss: 2.2030, label: 2,  bag_size: 10916
batch 664, cls loss: 0.6761, label: 0,  bag_size: 2323
batch 669, cls loss: 0.0127, label: 2,  bag_size: 11487
batch 674, cls loss: 0.3241, label: 0,  bag_size: 7650
batch 679, cls loss: 0.4721, label: 0,  bag_size: 9321
batch 684, cls loss: 0.1177, label: 0,  bag_size: 5317
batch 689, cls loss: 0.0324, label: 2,  bag_size: 1173
batch 694, cls loss: 1.1579, label: 2,  bag_size: 1012
batch 699, cls loss: 0.3877, label: 0,  bag_size: 10848
batch 704, cls loss: 0.0097, label: 2,  bag_size: 13396
batch 709, cls loss: 0.3278, label: 0,  bag_size: 6430
batch 714, cls loss: 1.0203, label: 1,  bag_size: 7781
batch 719, cls loss: 0.0848, label: 0,  bag_size: 9519
batch 724, cls loss: 0.2949, label: 2,  bag_size: 4167
batch 729, cls loss: 0.2544, label: 0,  bag_size: 11701
batch 734, cls loss: 0.0913, label: 0,  bag_size: 15665
batch 739, cls loss: 0.0363, label: 2,  bag_size: 13367
batch 744, cls loss: 0.0320, label: 2,  bag_size: 9575
batch 749, cls loss: 0.2373, label: 0,  bag_size: 3461
batch 754, cls loss: 0.2903, label: 0,  bag_size: 5661
batch 759, cls loss: 1.0330, label: 0,  bag_size: 13367
batch 764, cls loss: 1.0122, label: 1,  bag_size: 2538
batch 769, cls loss: 0.0340, label: 2,  bag_size: 2677
batch 774, cls loss: 0.9774, label: 0,  bag_size: 5441
batch 779, cls loss: 0.0140, label: 2,  bag_size: 1178
batch 784, cls loss: 0.4932, label: 0,  bag_size: 10400
batch 789, cls loss: 0.1944, label: 2,  bag_size: 1597
batch 794, cls loss: 0.0500, label: 2,  bag_size: 4883
batch 799, cls loss: 4.6124, label: 1,  bag_size: 9600
batch 804, cls loss: 0.3302, label: 0,  bag_size: 2807
batch 809, cls loss: 0.1388, label: 0,  bag_size: 1999
batch 814, cls loss: 0.1513, label: 0,  bag_size: 10392
batch 819, cls loss: 1.6807, label: 1,  bag_size: 17536
batch 824, cls loss: 0.6017, label: 1,  bag_size: 5123
batch 829, cls loss: 0.7811, label: 0,  bag_size: 9561
batch 834, cls loss: 0.0673, label: 2,  bag_size: 1279
batch 839, cls loss: 0.2548, label: 2,  bag_size: 9161
batch 844, cls loss: 0.2242, label: 0,  bag_size: 4821
batch 849, cls loss: 0.0211, label: 2,  bag_size: 3229
batch 854, cls loss: 0.0380, label: 2,  bag_size: 1216
batch 859, cls loss: 0.7225, label: 1,  bag_size: 6793
batch 864, cls loss: 0.3525, label: 0,  bag_size: 17579
batch 869, cls loss: 0.3919, label: 1,  bag_size: 11288
batch 874, cls loss: 0.3140, label: 2,  bag_size: 490
batch 879, cls loss: 1.3375, label: 1,  bag_size: 3966
batch 884, cls loss: 0.3057, label: 0,  bag_size: 9258
batch 889, cls loss: 1.0326, label: 0,  bag_size: 17880
batch 894, cls loss: 0.7290, label: 0,  bag_size: 1503
batch 899, cls loss: 0.2174, label: 2,  bag_size: 7533
batch 904, cls loss: 4.2414, label: 2,  bag_size: 3593
batch 909, cls loss: 0.0531, label: 2,  bag_size: 3557
batch 914, cls loss: 1.2074, label: 0,  bag_size: 5563
batch 919, cls loss: 2.5214, label: 1,  bag_size: 5373
batch 924, cls loss: 1.8526, label: 1,  bag_size: 3149
batch 929, cls loss: 0.3771, label: 0,  bag_size: 2385
batch 934, cls loss: 0.0098, label: 2,  bag_size: 1850
batch 939, cls loss: 0.2527, label: 0,  bag_size: 12349
batch 944, cls loss: 0.3645, label: 0,  bag_size: 12946
batch 949, cls loss: 0.6251, label: 2,  bag_size: 2000
batch 954, cls loss: 1.7298, label: 1,  bag_size: 2856
batch 959, cls loss: 0.1558, label: 0,  bag_size: 8868
batch 964, cls loss: 0.5049, label: 0,  bag_size: 10622
batch 969, cls loss: 0.1070, label: 0,  bag_size: 9408
batch 974, cls loss: 0.0875, label: 2,  bag_size: 6276
batch 979, cls loss: 0.0205, label: 2,  bag_size: 3304
batch 984, cls loss: 0.3797, label: 0,  bag_size: 2146
batch 989, cls loss: 1.5305, label: 0,  bag_size: 19470
batch 994, cls loss: 0.6449, label: 1,  bag_size: 4443
batch 999, cls loss: 0.1108, label: 0,  bag_size: 5256
batch 1004, cls loss: 0.7544, label: 2,  bag_size: 17282
batch 1009, cls loss: 0.0029, label: 2,  bag_size: 1436
batch 1014, cls loss: 1.1071, label: 1,  bag_size: 17508
batch 1019, cls loss: 0.4003, label: 0,  bag_size: 3640
batch 1024, cls loss: 0.2242, label: 0,  bag_size: 12791
batch 1029, cls loss: 0.4693, label: 0,  bag_size: 4209
batch 1034, cls loss: 0.4508, label: 2,  bag_size: 4958
batch 1039, cls loss: 2.0913, label: 2,  bag_size: 2676
batch 1044, cls loss: 0.1075, label: 0,  bag_size: 1123
batch 1049, cls loss: 0.4339, label: 0,  bag_size: 12494
batch 1054, cls loss: 1.6100, label: 1,  bag_size: 4105
batch 1059, cls loss: 0.0525, label: 2,  bag_size: 1035
batch 1064, cls loss: 0.3359, label: 0,  bag_size: 1038
batch 1069, cls loss: 1.6517, label: 1,  bag_size: 1586
batch 1074, cls loss: 0.4725, label: 0,  bag_size: 21450
batch 1079, cls loss: 0.1085, label: 2,  bag_size: 3585
batch 1084, cls loss: 0.7044, label: 1,  bag_size: 3525
batch 1089, cls loss: 0.1981, label: 0,  bag_size: 5023
batch 1094, cls loss: 0.0283, label: 2,  bag_size: 2606
batch 1099, cls loss: 0.4787, label: 1,  bag_size: 2754
batch 1104, cls loss: 0.3209, label: 0,  bag_size: 4956
batch 1109, cls loss: 1.5406, label: 1,  bag_size: 9431
batch 1114, cls loss: 0.0469, label: 2,  bag_size: 14677
batch 1119, cls loss: 2.1091, label: 1,  bag_size: 11756
batch 1124, cls loss: 0.7886, label: 0,  bag_size: 6360
batch 1129, cls loss: 0.1228, label: 0,  bag_size: 6317
batch 1134, cls loss: 0.5979, label: 1,  bag_size: 2944
batch 1139, cls loss: 0.1598, label: 0,  bag_size: 1316
batch 1144, cls loss: 0.0045, label: 2,  bag_size: 5068
batch 1149, cls loss: 0.0031, label: 2,  bag_size: 2200
batch 1154, cls loss: 0.1221, label: 0,  bag_size: 7669
batch 1159, cls loss: 2.3391, label: 1,  bag_size: 10160
batch 1164, cls loss: 0.4332, label: 2,  bag_size: 6319
batch 1169, cls loss: 1.1617, label: 1,  bag_size: 3689
batch 1174, cls loss: 2.0482, label: 0,  bag_size: 1127
batch 1179, cls loss: 0.4119, label: 2,  bag_size: 8866
batch 1184, cls loss: 0.0940, label: 0,  bag_size: 684
batch 1189, cls loss: 2.4988, label: 2,  bag_size: 6282
batch 1194, cls loss: 0.0613, label: 0,  bag_size: 15093
batch 1199, cls loss: 0.0020, label: 2,  bag_size: 15502
batch 1204, cls loss: 0.8099, label: 0,  bag_size: 5231
batch 1209, cls loss: 0.2104, label: 2,  bag_size: 3865
batch 1214, cls loss: 0.4942, label: 2,  bag_size: 21007
batch 1219, cls loss: 0.3861, label: 0,  bag_size: 1649
batch 1224, cls loss: 0.2982, label: 2,  bag_size: 2793
batch 1229, cls loss: 0.4392, label: 0,  bag_size: 5160
batch 1234, cls loss: 0.6334, label: 1,  bag_size: 10670
batch 1239, cls loss: 0.2105, label: 2,  bag_size: 1728
batch 1244, cls loss: 0.8430, label: 2,  bag_size: 2593
batch 1249, cls loss: 0.3131, label: 0,  bag_size: 8040
batch 1254, cls loss: 0.2365, label: 0,  bag_size: 1525
batch 1259, cls loss: 0.2014, label: 1,  bag_size: 7156
batch 1264, cls loss: 0.1402, label: 0,  bag_size: 3437
batch 1269, cls loss: 0.0815, label: 0,  bag_size: 11195
batch 1274, cls loss: 2.3531, label: 1,  bag_size: 876
batch 1279, cls loss: 0.3615, label: 1,  bag_size: 4291
batch 1284, cls loss: 0.0819, label: 2,  bag_size: 7147
batch 1289, cls loss: 0.9165, label: 1,  bag_size: 4072
batch 1294, cls loss: 0.1610, label: 0,  bag_size: 9877
batch 1299, cls loss: 0.6174, label: 0,  bag_size: 8026
batch 1304, cls loss: 0.1018, label: 0,  bag_size: 7381
batch 1309, cls loss: 0.1567, label: 0,  bag_size: 5155
Epoch: 0, cls train_loss: 0.6799, cls train_error: 0.2922
class 0: tpr 0.8964401294498382, correct 554/618
class 1: tpr 0.21011673151750973, correct 54/257
class 2: tpr 0.7334851936218679, correct 322/439
Traceback (most recent call last):
  File "main_mtl_concat_LSCC_CCRCC_CM.py", line 214, in <module>
    results = main(args)
  File "main_mtl_concat_LSCC_CCRCC_CM.py", line 60, in main
    results, cls_test_auc, cls_val_auc, cls_test_acc, cls_val_acc = train(datasets, i, args)
  File "/home/daichuangchuang/Nature/Ltoad_exclude_sex/utils/core_utils_mtl_concat.py", line 160, in train
    early_stopping, writer, loss_fn, args.results_dir)
  File "/home/daichuangchuang/Nature/Ltoad_exclude_sex/utils/core_utils_mtl_concat.py", line 270, in validate
    for batch_idx, (data, label, site, sex) in enumerate(loader):
ValueError: not enough values to unpack (expected 4, got 2)
(toad) daichuangchuang@DELLW01:~/Nature/Ltoad_exclude_sex$ CUDA_VISIBLE_DEVICES=0 python main_mtl_concat_LSCC_CCRCC_CM.py --drop_out --early_stopping --lr 2e-4 --k 1 --exp_code dummy_mtl_sex  --task dummy_mtl_concat  --log_data --data_root_dir /home/daichuangchuang/Nature/CLAM/data_root_dir

Load Dataset
task:  0
label column: label
label dictionary: {'Lung': 0, 'Skin': 1, 'Kidney': 2}
number of classes: 3
slide-level counts:
 0    681
1    284
2    505
Name: label, dtype: int64
Patient-LVL; Number of samples registered in class 0: 210
Slide-LVL; Number of samples registered in class 0: 681
Patient-LVL; Number of samples registered in class 1: 93
Slide-LVL; Number of samples registered in class 1: 284
Patient-LVL; Number of samples registered in class 2: 216
Slide-LVL; Number of samples registered in class 2: 505
################# Settings ###################
num_splits:  1
k_start:  -1
k_end:  -1
task:  dummy_mtl_concat
max_epochs:  200
results_dir:  ./results
lr:  0.0002
experiment:  dummy_mtl_sex
reg:  1e-05
seed:  1
use_drop_out:  True
weighted_sample:  False
opt:  adam
split_dir:  splits_LSCC_CM_CCRCC/dummy_mtl_concat_100
training: 1314, validation: 52, testing: 104

Training Fold 0!

Init train/val/test splits... Done!
Training on 1314 samples
Validating on 52 samples
Testing on 104 samples

Init Model... Done!
TOAD_fc_mtl_concat(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Linear(in_features=512, out_features=512, bias=True)
    (4): ReLU()
    (5): Dropout(p=0.25, inplace=False)
    (6): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=384, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=384, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=384, out_features=1, bias=True)
    )
  )
  (classifier): Linear(in_features=512, out_features=3, bias=True)
)
Total number of parameters: 1183364
Total number of trainable parameters: 1183364

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 4, cls loss: 1.0414, label: 0,  bag_size: 5237
batch 9, cls loss: 1.2882, label: 2,  bag_size: 12703
batch 14, cls loss: 1.0959, label: 1,  bag_size: 9535
batch 19, cls loss: 1.0350, label: 0,  bag_size: 9065
batch 24, cls loss: 1.0399, label: 0,  bag_size: 1015
batch 29, cls loss: 1.2164, label: 1,  bag_size: 2813
batch 34, cls loss: 0.8772, label: 0,  bag_size: 6736
batch 39, cls loss: 1.3283, label: 2,  bag_size: 1166
batch 44, cls loss: 1.3392, label: 2,  bag_size: 2219
batch 49, cls loss: 1.2834, label: 1,  bag_size: 12167
batch 54, cls loss: 1.2790, label: 2,  bag_size: 2825
batch 59, cls loss: 1.2564, label: 1,  bag_size: 7163
batch 64, cls loss: 1.0893, label: 2,  bag_size: 5756
batch 69, cls loss: 1.4708, label: 1,  bag_size: 834
batch 74, cls loss: 1.0391, label: 0,  bag_size: 2759
batch 79, cls loss: 1.5187, label: 1,  bag_size: 3690
batch 84, cls loss: 0.9508, label: 0,  bag_size: 5163
batch 89, cls loss: 1.4477, label: 1,  bag_size: 16743
batch 94, cls loss: 1.3680, label: 1,  bag_size: 3458
batch 99, cls loss: 0.8988, label: 0,  bag_size: 10028
batch 104, cls loss: 1.1772, label: 2,  bag_size: 7216
batch 109, cls loss: 1.0921, label: 2,  bag_size: 3098
batch 114, cls loss: 1.3192, label: 1,  bag_size: 12192
batch 119, cls loss: 1.2557, label: 2,  bag_size: 4344
batch 124, cls loss: 0.7049, label: 0,  bag_size: 7981
batch 129, cls loss: 0.6523, label: 0,  bag_size: 5308
batch 134, cls loss: 0.5971, label: 0,  bag_size: 4442
batch 139, cls loss: 2.1181, label: 1,  bag_size: 1102
batch 144, cls loss: 0.5200, label: 0,  bag_size: 6239
batch 149, cls loss: 2.4126, label: 1,  bag_size: 3609
batch 154, cls loss: 0.8454, label: 2,  bag_size: 3203
batch 159, cls loss: 0.7925, label: 0,  bag_size: 6781
batch 164, cls loss: 0.7717, label: 0,  bag_size: 9215
batch 169, cls loss: 1.7047, label: 1,  bag_size: 714
batch 174, cls loss: 0.6288, label: 0,  bag_size: 11266
batch 179, cls loss: 1.5132, label: 1,  bag_size: 1664
batch 184, cls loss: 0.5219, label: 0,  bag_size: 14433
batch 189, cls loss: 0.4213, label: 0,  bag_size: 1753
batch 194, cls loss: 0.5517, label: 0,  bag_size: 1064
batch 199, cls loss: 0.5634, label: 0,  bag_size: 2966
batch 204, cls loss: 0.6811, label: 0,  bag_size: 3576
batch 209, cls loss: 1.8240, label: 1,  bag_size: 1941
batch 214, cls loss: 0.5930, label: 0,  bag_size: 10169
batch 219, cls loss: 1.7401, label: 1,  bag_size: 6311
batch 224, cls loss: 1.5870, label: 1,  bag_size: 3110
batch 229, cls loss: 1.7708, label: 1,  bag_size: 1612
batch 234, cls loss: 0.3427, label: 2,  bag_size: 2065
batch 239, cls loss: 0.9055, label: 0,  bag_size: 11875
batch 244, cls loss: 1.1700, label: 1,  bag_size: 12107
batch 249, cls loss: 0.6618, label: 0,  bag_size: 6016
batch 254, cls loss: 0.4717, label: 0,  bag_size: 18468
batch 259, cls loss: 0.5287, label: 0,  bag_size: 19439
batch 264, cls loss: 0.3217, label: 0,  bag_size: 1657
batch 269, cls loss: 1.6936, label: 1,  bag_size: 5739
batch 274, cls loss: 0.8674, label: 2,  bag_size: 5303
batch 279, cls loss: 0.2712, label: 2,  bag_size: 2629
batch 284, cls loss: 0.3282, label: 2,  bag_size: 7082
batch 289, cls loss: 0.8748, label: 0,  bag_size: 11964
batch 294, cls loss: 0.4030, label: 0,  bag_size: 2936
batch 299, cls loss: 0.3828, label: 0,  bag_size: 9393
batch 304, cls loss: 0.1915, label: 0,  bag_size: 9610
batch 309, cls loss: 1.9583, label: 1,  bag_size: 2511
batch 314, cls loss: 0.3699, label: 2,  bag_size: 3124
batch 319, cls loss: 0.1169, label: 2,  bag_size: 1322
batch 324, cls loss: 0.5714, label: 2,  bag_size: 2819
batch 329, cls loss: 0.3214, label: 0,  bag_size: 20767
batch 334, cls loss: 0.2450, label: 2,  bag_size: 2709
batch 339, cls loss: 0.2014, label: 0,  bag_size: 12408
batch 344, cls loss: 2.2078, label: 1,  bag_size: 1082
batch 349, cls loss: 1.7110, label: 2,  bag_size: 8653
batch 354, cls loss: 0.4732, label: 0,  bag_size: 1867
batch 359, cls loss: 0.6626, label: 0,  bag_size: 16703
batch 364, cls loss: 0.0287, label: 2,  bag_size: 4442
batch 369, cls loss: 1.8810, label: 1,  bag_size: 13121
batch 374, cls loss: 0.2487, label: 2,  bag_size: 14572
batch 379, cls loss: 1.5408, label: 1,  bag_size: 881
batch 384, cls loss: 0.2365, label: 0,  bag_size: 4120
batch 389, cls loss: 0.2076, label: 0,  bag_size: 13791
batch 394, cls loss: 1.3123, label: 1,  bag_size: 7248
batch 399, cls loss: 1.5281, label: 2,  bag_size: 7917
batch 404, cls loss: 1.5724, label: 1,  bag_size: 26724
batch 409, cls loss: 1.6271, label: 1,  bag_size: 2620
batch 414, cls loss: 0.5669, label: 0,  bag_size: 5516
batch 419, cls loss: 0.3415, label: 0,  bag_size: 4959
batch 424, cls loss: 1.1499, label: 1,  bag_size: 8254
batch 429, cls loss: 0.1515, label: 2,  bag_size: 6045
batch 434, cls loss: 0.4747, label: 0,  bag_size: 4039
batch 439, cls loss: 0.0518, label: 2,  bag_size: 2335
batch 444, cls loss: 0.1139, label: 2,  bag_size: 2078
batch 449, cls loss: 0.2836, label: 2,  bag_size: 5664
batch 454, cls loss: 0.9738, label: 1,  bag_size: 8759
batch 459, cls loss: 0.6813, label: 1,  bag_size: 2403
batch 464, cls loss: 0.5338, label: 0,  bag_size: 16512
batch 469, cls loss: 0.8821, label: 1,  bag_size: 4811
batch 474, cls loss: 1.1921, label: 1,  bag_size: 1612
batch 479, cls loss: 1.1460, label: 1,  bag_size: 15582
batch 484, cls loss: 0.3603, label: 2,  bag_size: 2068
batch 489, cls loss: 0.5602, label: 1,  bag_size: 3473
batch 494, cls loss: 1.1023, label: 0,  bag_size: 4786
batch 499, cls loss: 0.3050, label: 2,  bag_size: 12594
batch 504, cls loss: 0.3215, label: 0,  bag_size: 6792
batch 509, cls loss: 0.1361, label: 2,  bag_size: 4358
batch 514, cls loss: 0.8161, label: 0,  bag_size: 7246
batch 519, cls loss: 0.7993, label: 0,  bag_size: 1746
batch 524, cls loss: 1.6691, label: 1,  bag_size: 9173
batch 529, cls loss: 0.2871, label: 0,  bag_size: 1776
batch 534, cls loss: 0.2459, label: 0,  bag_size: 15931
batch 539, cls loss: 0.2196, label: 2,  bag_size: 1690
batch 544, cls loss: 0.1186, label: 2,  bag_size: 3655
batch 549, cls loss: 0.2017, label: 2,  bag_size: 8383
batch 554, cls loss: 0.0502, label: 2,  bag_size: 2263
batch 559, cls loss: 0.9180, label: 1,  bag_size: 5505
batch 564, cls loss: 0.2919, label: 2,  bag_size: 13622
batch 569, cls loss: 0.4011, label: 0,  bag_size: 10432
batch 574, cls loss: 1.1149, label: 1,  bag_size: 5727
batch 579, cls loss: 0.0643, label: 2,  bag_size: 4419
batch 584, cls loss: 0.3965, label: 0,  bag_size: 5690
batch 589, cls loss: 0.3707, label: 0,  bag_size: 8012
batch 594, cls loss: 0.0305, label: 2,  bag_size: 3781
batch 599, cls loss: 0.9071, label: 1,  bag_size: 3541
batch 604, cls loss: 0.2250, label: 0,  bag_size: 11884
batch 609, cls loss: 0.1580, label: 0,  bag_size: 1412
batch 614, cls loss: 3.1368, label: 2,  bag_size: 7810
batch 619, cls loss: 1.4561, label: 2,  bag_size: 4443
batch 624, cls loss: 0.4855, label: 1,  bag_size: 5316
batch 629, cls loss: 0.8989, label: 1,  bag_size: 5576
batch 634, cls loss: 0.0273, label: 2,  bag_size: 10345
batch 639, cls loss: 0.3989, label: 0,  bag_size: 7110
batch 644, cls loss: 0.2324, label: 0,  bag_size: 11394
batch 649, cls loss: 0.0858, label: 0,  bag_size: 5561
batch 654, cls loss: 0.2484, label: 0,  bag_size: 3879
batch 659, cls loss: 2.2030, label: 2,  bag_size: 10916
batch 664, cls loss: 0.6761, label: 0,  bag_size: 2323
batch 669, cls loss: 0.0127, label: 2,  bag_size: 11487
batch 674, cls loss: 0.3241, label: 0,  bag_size: 7650
batch 679, cls loss: 0.4721, label: 0,  bag_size: 9321
batch 684, cls loss: 0.1177, label: 0,  bag_size: 5317
batch 689, cls loss: 0.0324, label: 2,  bag_size: 1173
batch 694, cls loss: 1.1579, label: 2,  bag_size: 1012
batch 699, cls loss: 0.3877, label: 0,  bag_size: 10848
batch 704, cls loss: 0.0097, label: 2,  bag_size: 13396
batch 709, cls loss: 0.3278, label: 0,  bag_size: 6430
batch 714, cls loss: 1.0203, label: 1,  bag_size: 7781
batch 719, cls loss: 0.0848, label: 0,  bag_size: 9519
batch 724, cls loss: 0.2949, label: 2,  bag_size: 4167
batch 729, cls loss: 0.2544, label: 0,  bag_size: 11701
batch 734, cls loss: 0.0913, label: 0,  bag_size: 15665
batch 739, cls loss: 0.0363, label: 2,  bag_size: 13367
batch 744, cls loss: 0.0320, label: 2,  bag_size: 9575
batch 749, cls loss: 0.2373, label: 0,  bag_size: 3461
batch 754, cls loss: 0.2903, label: 0,  bag_size: 5661
batch 759, cls loss: 1.0330, label: 0,  bag_size: 13367
batch 764, cls loss: 1.0122, label: 1,  bag_size: 2538
batch 769, cls loss: 0.0340, label: 2,  bag_size: 2677
batch 774, cls loss: 0.9774, label: 0,  bag_size: 5441
batch 779, cls loss: 0.0140, label: 2,  bag_size: 1178
batch 784, cls loss: 0.4932, label: 0,  bag_size: 10400
batch 789, cls loss: 0.1944, label: 2,  bag_size: 1597
batch 794, cls loss: 0.0500, label: 2,  bag_size: 4883
batch 799, cls loss: 4.6124, label: 1,  bag_size: 9600
batch 804, cls loss: 0.3302, label: 0,  bag_size: 2807
batch 809, cls loss: 0.1388, label: 0,  bag_size: 1999
batch 814, cls loss: 0.1513, label: 0,  bag_size: 10392
batch 819, cls loss: 1.6807, label: 1,  bag_size: 17536
batch 824, cls loss: 0.6017, label: 1,  bag_size: 5123
batch 829, cls loss: 0.7811, label: 0,  bag_size: 9561
batch 834, cls loss: 0.0673, label: 2,  bag_size: 1279
batch 839, cls loss: 0.2548, label: 2,  bag_size: 9161
batch 844, cls loss: 0.2242, label: 0,  bag_size: 4821
batch 849, cls loss: 0.0211, label: 2,  bag_size: 3229
batch 854, cls loss: 0.0380, label: 2,  bag_size: 1216
batch 859, cls loss: 0.7225, label: 1,  bag_size: 6793
batch 864, cls loss: 0.3525, label: 0,  bag_size: 17579
batch 869, cls loss: 0.3919, label: 1,  bag_size: 11288
batch 874, cls loss: 0.3140, label: 2,  bag_size: 490
batch 879, cls loss: 1.3375, label: 1,  bag_size: 3966
batch 884, cls loss: 0.3057, label: 0,  bag_size: 9258
batch 889, cls loss: 1.0326, label: 0,  bag_size: 17880
batch 894, cls loss: 0.7290, label: 0,  bag_size: 1503
batch 899, cls loss: 0.2174, label: 2,  bag_size: 7533
batch 904, cls loss: 4.2414, label: 2,  bag_size: 3593
batch 909, cls loss: 0.0531, label: 2,  bag_size: 3557
batch 914, cls loss: 1.2074, label: 0,  bag_size: 5563
batch 919, cls loss: 2.5214, label: 1,  bag_size: 5373
batch 924, cls loss: 1.8526, label: 1,  bag_size: 3149
batch 929, cls loss: 0.3771, label: 0,  bag_size: 2385
batch 934, cls loss: 0.0098, label: 2,  bag_size: 1850
batch 939, cls loss: 0.2527, label: 0,  bag_size: 12349
batch 944, cls loss: 0.3645, label: 0,  bag_size: 12946
batch 949, cls loss: 0.6251, label: 2,  bag_size: 2000
batch 954, cls loss: 1.7298, label: 1,  bag_size: 2856
batch 959, cls loss: 0.1558, label: 0,  bag_size: 8868
batch 964, cls loss: 0.5049, label: 0,  bag_size: 10622
batch 969, cls loss: 0.1070, label: 0,  bag_size: 9408
batch 974, cls loss: 0.0875, label: 2,  bag_size: 6276
batch 979, cls loss: 0.0205, label: 2,  bag_size: 3304
batch 984, cls loss: 0.3797, label: 0,  bag_size: 2146
batch 989, cls loss: 1.5305, label: 0,  bag_size: 19470
batch 994, cls loss: 0.6449, label: 1,  bag_size: 4443
batch 999, cls loss: 0.1108, label: 0,  bag_size: 5256
batch 1004, cls loss: 0.7544, label: 2,  bag_size: 17282
batch 1009, cls loss: 0.0029, label: 2,  bag_size: 1436
batch 1014, cls loss: 1.1071, label: 1,  bag_size: 17508
batch 1019, cls loss: 0.4003, label: 0,  bag_size: 3640
batch 1024, cls loss: 0.2242, label: 0,  bag_size: 12791
batch 1029, cls loss: 0.4693, label: 0,  bag_size: 4209
batch 1034, cls loss: 0.4508, label: 2,  bag_size: 4958
batch 1039, cls loss: 2.0913, label: 2,  bag_size: 2676
batch 1044, cls loss: 0.1075, label: 0,  bag_size: 1123
batch 1049, cls loss: 0.4339, label: 0,  bag_size: 12494
batch 1054, cls loss: 1.6100, label: 1,  bag_size: 4105
batch 1059, cls loss: 0.0525, label: 2,  bag_size: 1035
batch 1064, cls loss: 0.3359, label: 0,  bag_size: 1038
batch 1069, cls loss: 1.6517, label: 1,  bag_size: 1586
batch 1074, cls loss: 0.4725, label: 0,  bag_size: 21450
batch 1079, cls loss: 0.1085, label: 2,  bag_size: 3585
batch 1084, cls loss: 0.7044, label: 1,  bag_size: 3525
batch 1089, cls loss: 0.1981, label: 0,  bag_size: 5023
batch 1094, cls loss: 0.0283, label: 2,  bag_size: 2606
batch 1099, cls loss: 0.4787, label: 1,  bag_size: 2754
batch 1104, cls loss: 0.3209, label: 0,  bag_size: 4956
batch 1109, cls loss: 1.5406, label: 1,  bag_size: 9431
batch 1114, cls loss: 0.0469, label: 2,  bag_size: 14677
batch 1119, cls loss: 2.1091, label: 1,  bag_size: 11756
batch 1124, cls loss: 0.7886, label: 0,  bag_size: 6360
batch 1129, cls loss: 0.1228, label: 0,  bag_size: 6317
batch 1134, cls loss: 0.5979, label: 1,  bag_size: 2944
batch 1139, cls loss: 0.1598, label: 0,  bag_size: 1316
batch 1144, cls loss: 0.0045, label: 2,  bag_size: 5068
batch 1149, cls loss: 0.0031, label: 2,  bag_size: 2200
batch 1154, cls loss: 0.1221, label: 0,  bag_size: 7669
batch 1159, cls loss: 2.3391, label: 1,  bag_size: 10160
batch 1164, cls loss: 0.4332, label: 2,  bag_size: 6319
batch 1169, cls loss: 1.1617, label: 1,  bag_size: 3689
batch 1174, cls loss: 2.0482, label: 0,  bag_size: 1127
batch 1179, cls loss: 0.4119, label: 2,  bag_size: 8866
batch 1184, cls loss: 0.0940, label: 0,  bag_size: 684
batch 1189, cls loss: 2.4988, label: 2,  bag_size: 6282
batch 1194, cls loss: 0.0613, label: 0,  bag_size: 15093
batch 1199, cls loss: 0.0020, label: 2,  bag_size: 15502
batch 1204, cls loss: 0.8099, label: 0,  bag_size: 5231
batch 1209, cls loss: 0.2104, label: 2,  bag_size: 3865
batch 1214, cls loss: 0.4942, label: 2,  bag_size: 21007
batch 1219, cls loss: 0.3861, label: 0,  bag_size: 1649
batch 1224, cls loss: 0.2982, label: 2,  bag_size: 2793
batch 1229, cls loss: 0.4392, label: 0,  bag_size: 5160
batch 1234, cls loss: 0.6334, label: 1,  bag_size: 10670
batch 1239, cls loss: 0.2105, label: 2,  bag_size: 1728
batch 1244, cls loss: 0.8430, label: 2,  bag_size: 2593
batch 1249, cls loss: 0.3131, label: 0,  bag_size: 8040
batch 1254, cls loss: 0.2365, label: 0,  bag_size: 1525
batch 1259, cls loss: 0.2014, label: 1,  bag_size: 7156
batch 1264, cls loss: 0.1402, label: 0,  bag_size: 3437
batch 1269, cls loss: 0.0815, label: 0,  bag_size: 11195
batch 1274, cls loss: 2.3531, label: 1,  bag_size: 876
batch 1279, cls loss: 0.3615, label: 1,  bag_size: 4291
batch 1284, cls loss: 0.0819, label: 2,  bag_size: 7147
batch 1289, cls loss: 0.9165, label: 1,  bag_size: 4072
batch 1294, cls loss: 0.1610, label: 0,  bag_size: 9877
batch 1299, cls loss: 0.6174, label: 0,  bag_size: 8026
batch 1304, cls loss: 0.1018, label: 0,  bag_size: 7381
batch 1309, cls loss: 0.1567, label: 0,  bag_size: 5155
Epoch: 0, cls train_loss: 0.6799, cls train_error: 0.2922
class 0: tpr 0.8964401294498382, correct 554/618
class 1: tpr 0.21011673151750973, correct 54/257
class 2: tpr 0.7334851936218679, correct 322/439
Traceback (most recent call last):
  File "main_mtl_concat_LSCC_CCRCC_CM.py", line 214, in <module>
    results = main(args)
  File "main_mtl_concat_LSCC_CCRCC_CM.py", line 60, in main
    results, cls_test_auc, cls_val_auc, cls_test_acc, cls_val_acc = train(datasets, i, args)
  File "/home/daichuangchuang/Nature/Ltoad_exclude_sex/utils/core_utils_mtl_concat.py", line 160, in train
    early_stopping, writer, loss_fn, args.results_dir)
  File "/home/daichuangchuang/Nature/Ltoad_exclude_sex/utils/core_utils_mtl_concat.py", line 270, in validate
    for batch_idx, (data, label) in enumerate(loader):
  File "/home/daichuangchuang/anaconda2/envs/toad/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 801, in __next__
    return self._process_data(data)
  File "/home/daichuangchuang/anaconda2/envs/toad/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 846, in _process_data
    data.reraise()
  File "/home/daichuangchuang/anaconda2/envs/toad/lib/python3.7/site-packages/torch/_utils.py", line 385, in reraise
    raise self.exc_type(msg)
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 2.
Original Traceback (most recent call last):
  File "/home/daichuangchuang/anaconda2/envs/toad/lib/python3.7/site-packages/torch/utils/data/_utils/worker.py", line 178, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/daichuangchuang/anaconda2/envs/toad/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/daichuangchuang/anaconda2/envs/toad/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/daichuangchuang/Nature/Ltoad_exclude_sex/datasets/dataset_mtl_concat.py", line 391, in __getitem__
    features = torch.load(full_path)  # number(patches number)*1024
  File "/home/daichuangchuang/anaconda2/envs/toad/lib/python3.7/site-packages/torch/serialization.py", line 419, in load
    f = open(f, 'rb')
FileNotFoundError: [Errno 2] No such file or directory: '/home/daichuangchuang/Nature/CLAM/DATA_ROOT_DIR/DATA_DIR/pt_files/C3N-02300-23.pt'

(toad) daichuangchuang@DELLW01:~/Nature/Ltoad_exclude_sex$ CUDA_VISIBLE_DEVICES=0 python main_mtl_concat_LSCC_CCRCC_CM.py --drop_out --early_stopping --lr 2e-4 --k 1 --exp_code dummy_mtl_sex  --task dummy_mtl_concat  --log_data --data_root_dir /home/daichuangchuang/Nature/CLAM/data_root_dir

Load Dataset
task:  0
label column: label
label dictionary: {'Lung': 0, 'Skin': 1, 'Kidney': 2}
number of classes: 3
slide-level counts:
 0    680
1    284
2    505
Name: label, dtype: int64
Patient-LVL; Number of samples registered in class 0: 210
Slide-LVL; Number of samples registered in class 0: 680
Patient-LVL; Number of samples registered in class 1: 93
Slide-LVL; Number of samples registered in class 1: 284
Patient-LVL; Number of samples registered in class 2: 216
Slide-LVL; Number of samples registered in class 2: 505
################# Settings ###################
num_splits:  1
k_start:  -1
k_end:  -1
task:  dummy_mtl_concat
max_epochs:  200
results_dir:  ./results
lr:  0.0002
experiment:  dummy_mtl_sex
reg:  1e-05
seed:  1
use_drop_out:  True
weighted_sample:  False
opt:  adam
split_dir:  splits_LSCC_CM_CCRCC/dummy_mtl_concat_100
training: 1314, validation: 51, testing: 104

Training Fold 0!

Init train/val/test splits... Done!
Training on 1314 samples
Validating on 51 samples
Testing on 104 samples

Init Model... Done!
TOAD_fc_mtl_concat(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Linear(in_features=512, out_features=512, bias=True)
    (4): ReLU()
    (5): Dropout(p=0.25, inplace=False)
    (6): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=384, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=384, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=384, out_features=1, bias=True)
    )
  )
  (classifier): Linear(in_features=512, out_features=3, bias=True)
)
Total number of parameters: 1183364
Total number of trainable parameters: 1183364

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 4, cls loss: 1.0414, label: 0,  bag_size: 5237
batch 9, cls loss: 1.2882, label: 2,  bag_size: 12703
batch 14, cls loss: 1.0959, label: 1,  bag_size: 9535
batch 19, cls loss: 1.0350, label: 0,  bag_size: 9065
batch 24, cls loss: 1.0399, label: 0,  bag_size: 1015
batch 29, cls loss: 1.2164, label: 1,  bag_size: 2813
batch 34, cls loss: 0.8772, label: 0,  bag_size: 6736
batch 39, cls loss: 1.3283, label: 2,  bag_size: 1166
batch 44, cls loss: 1.3392, label: 2,  bag_size: 2219
batch 49, cls loss: 1.2834, label: 1,  bag_size: 12167
batch 54, cls loss: 1.2790, label: 2,  bag_size: 2825
batch 59, cls loss: 1.2564, label: 1,  bag_size: 7163
batch 64, cls loss: 1.0893, label: 2,  bag_size: 5756
batch 69, cls loss: 1.4708, label: 1,  bag_size: 834
batch 74, cls loss: 1.0391, label: 0,  bag_size: 2759
batch 79, cls loss: 1.5187, label: 1,  bag_size: 3690
batch 84, cls loss: 0.9508, label: 0,  bag_size: 5163
batch 89, cls loss: 1.4477, label: 1,  bag_size: 16743
batch 94, cls loss: 1.3680, label: 1,  bag_size: 3458
batch 99, cls loss: 0.8988, label: 0,  bag_size: 10028
batch 104, cls loss: 1.1772, label: 2,  bag_size: 7216
batch 109, cls loss: 1.0921, label: 2,  bag_size: 3098
batch 114, cls loss: 1.3192, label: 1,  bag_size: 12192
batch 119, cls loss: 1.2557, label: 2,  bag_size: 4344
batch 124, cls loss: 0.7049, label: 0,  bag_size: 7981
batch 129, cls loss: 0.6523, label: 0,  bag_size: 5308
batch 134, cls loss: 0.5971, label: 0,  bag_size: 4442
batch 139, cls loss: 2.1181, label: 1,  bag_size: 1102
batch 144, cls loss: 0.5200, label: 0,  bag_size: 6239
batch 149, cls loss: 2.4126, label: 1,  bag_size: 3609
batch 154, cls loss: 0.8454, label: 2,  bag_size: 3203
batch 159, cls loss: 0.7925, label: 0,  bag_size: 6781
batch 164, cls loss: 0.7717, label: 0,  bag_size: 9215
batch 169, cls loss: 1.7047, label: 1,  bag_size: 714
batch 174, cls loss: 0.6288, label: 0,  bag_size: 11266
batch 179, cls loss: 1.5132, label: 1,  bag_size: 1664
batch 184, cls loss: 0.5219, label: 0,  bag_size: 14433
batch 189, cls loss: 0.4213, label: 0,  bag_size: 1753
batch 194, cls loss: 0.5517, label: 0,  bag_size: 1064
batch 199, cls loss: 0.5634, label: 0,  bag_size: 2966
batch 204, cls loss: 0.6811, label: 0,  bag_size: 3576
batch 209, cls loss: 1.8240, label: 1,  bag_size: 1941
batch 214, cls loss: 0.5930, label: 0,  bag_size: 10169
batch 219, cls loss: 1.7401, label: 1,  bag_size: 6311
batch 224, cls loss: 1.5870, label: 1,  bag_size: 3110
batch 229, cls loss: 1.7708, label: 1,  bag_size: 1612
batch 234, cls loss: 0.3427, label: 2,  bag_size: 2065
batch 239, cls loss: 0.9055, label: 0,  bag_size: 11875
batch 244, cls loss: 1.1700, label: 1,  bag_size: 12107
batch 249, cls loss: 0.6618, label: 0,  bag_size: 6016
batch 254, cls loss: 0.4717, label: 0,  bag_size: 18468
batch 259, cls loss: 0.5287, label: 0,  bag_size: 19439
batch 264, cls loss: 0.3217, label: 0,  bag_size: 1657
batch 269, cls loss: 1.6936, label: 1,  bag_size: 5739
batch 274, cls loss: 0.8674, label: 2,  bag_size: 5303
batch 279, cls loss: 0.2712, label: 2,  bag_size: 2629
batch 284, cls loss: 0.3282, label: 2,  bag_size: 7082
batch 289, cls loss: 0.8748, label: 0,  bag_size: 11964
batch 294, cls loss: 0.4030, label: 0,  bag_size: 2936
batch 299, cls loss: 0.3828, label: 0,  bag_size: 9393
batch 304, cls loss: 0.1915, label: 0,  bag_size: 9610
batch 309, cls loss: 1.9583, label: 1,  bag_size: 2511
batch 314, cls loss: 0.3699, label: 2,  bag_size: 3124
batch 319, cls loss: 0.1169, label: 2,  bag_size: 1322
batch 324, cls loss: 0.5714, label: 2,  bag_size: 2819
batch 329, cls loss: 0.3214, label: 0,  bag_size: 20767
batch 334, cls loss: 0.2450, label: 2,  bag_size: 2709
batch 339, cls loss: 0.2014, label: 0,  bag_size: 12408
batch 344, cls loss: 2.2078, label: 1,  bag_size: 1082
batch 349, cls loss: 1.7110, label: 2,  bag_size: 8653
batch 354, cls loss: 0.4732, label: 0,  bag_size: 1867
batch 359, cls loss: 0.6626, label: 0,  bag_size: 16703
batch 364, cls loss: 0.0287, label: 2,  bag_size: 4442
batch 369, cls loss: 1.8810, label: 1,  bag_size: 13121
batch 374, cls loss: 0.2487, label: 2,  bag_size: 14572
batch 379, cls loss: 1.5408, label: 1,  bag_size: 881
batch 384, cls loss: 0.2365, label: 0,  bag_size: 4120
batch 389, cls loss: 0.2076, label: 0,  bag_size: 13791
batch 394, cls loss: 1.3123, label: 1,  bag_size: 7248
batch 399, cls loss: 1.5281, label: 2,  bag_size: 7917
batch 404, cls loss: 1.5724, label: 1,  bag_size: 26724
batch 409, cls loss: 1.6271, label: 1,  bag_size: 2620
batch 414, cls loss: 0.5669, label: 0,  bag_size: 5516
batch 419, cls loss: 0.3415, label: 0,  bag_size: 4959
batch 424, cls loss: 1.1499, label: 1,  bag_size: 8254
batch 429, cls loss: 0.1515, label: 2,  bag_size: 6045
batch 434, cls loss: 0.4747, label: 0,  bag_size: 4039
batch 439, cls loss: 0.0518, label: 2,  bag_size: 2335
batch 444, cls loss: 0.1139, label: 2,  bag_size: 2078
batch 449, cls loss: 0.2836, label: 2,  bag_size: 5664
batch 454, cls loss: 0.9738, label: 1,  bag_size: 8759
batch 459, cls loss: 0.6813, label: 1,  bag_size: 2403
batch 464, cls loss: 0.5338, label: 0,  bag_size: 16512
batch 469, cls loss: 0.8821, label: 1,  bag_size: 4811
batch 474, cls loss: 1.1921, label: 1,  bag_size: 1612
batch 479, cls loss: 1.1460, label: 1,  bag_size: 15582
batch 484, cls loss: 0.3603, label: 2,  bag_size: 2068
batch 489, cls loss: 0.5602, label: 1,  bag_size: 3473
batch 494, cls loss: 1.1023, label: 0,  bag_size: 4786
batch 499, cls loss: 0.3050, label: 2,  bag_size: 12594
batch 504, cls loss: 0.3215, label: 0,  bag_size: 6792
batch 509, cls loss: 0.1361, label: 2,  bag_size: 4358
batch 514, cls loss: 0.8161, label: 0,  bag_size: 7246
batch 519, cls loss: 0.7993, label: 0,  bag_size: 1746
batch 524, cls loss: 1.6691, label: 1,  bag_size: 9173
batch 529, cls loss: 0.2871, label: 0,  bag_size: 1776
batch 534, cls loss: 0.2459, label: 0,  bag_size: 15931
batch 539, cls loss: 0.2196, label: 2,  bag_size: 1690
batch 544, cls loss: 0.1186, label: 2,  bag_size: 3655
batch 549, cls loss: 0.2017, label: 2,  bag_size: 8383
batch 554, cls loss: 0.0502, label: 2,  bag_size: 2263
batch 559, cls loss: 0.9180, label: 1,  bag_size: 5505
batch 564, cls loss: 0.2919, label: 2,  bag_size: 13622
batch 569, cls loss: 0.4011, label: 0,  bag_size: 10432
batch 574, cls loss: 1.1149, label: 1,  bag_size: 5727
batch 579, cls loss: 0.0643, label: 2,  bag_size: 4419
batch 584, cls loss: 0.3965, label: 0,  bag_size: 5690
batch 589, cls loss: 0.3707, label: 0,  bag_size: 8012
batch 594, cls loss: 0.0305, label: 2,  bag_size: 3781
batch 599, cls loss: 0.9071, label: 1,  bag_size: 3541
batch 604, cls loss: 0.2250, label: 0,  bag_size: 11884
batch 609, cls loss: 0.1580, label: 0,  bag_size: 1412
batch 614, cls loss: 3.1368, label: 2,  bag_size: 7810
batch 619, cls loss: 1.4561, label: 2,  bag_size: 4443
batch 624, cls loss: 0.4855, label: 1,  bag_size: 5316
batch 629, cls loss: 0.8989, label: 1,  bag_size: 5576
batch 634, cls loss: 0.0273, label: 2,  bag_size: 10345
batch 639, cls loss: 0.3989, label: 0,  bag_size: 7110
batch 644, cls loss: 0.2324, label: 0,  bag_size: 11394
batch 649, cls loss: 0.0858, label: 0,  bag_size: 5561
batch 654, cls loss: 0.2484, label: 0,  bag_size: 3879
batch 659, cls loss: 2.2030, label: 2,  bag_size: 10916
batch 664, cls loss: 0.6761, label: 0,  bag_size: 2323
batch 669, cls loss: 0.0127, label: 2,  bag_size: 11487
batch 674, cls loss: 0.3241, label: 0,  bag_size: 7650
batch 679, cls loss: 0.4721, label: 0,  bag_size: 9321
batch 684, cls loss: 0.1177, label: 0,  bag_size: 5317
batch 689, cls loss: 0.0324, label: 2,  bag_size: 1173
batch 694, cls loss: 1.1579, label: 2,  bag_size: 1012
batch 699, cls loss: 0.3877, label: 0,  bag_size: 10848
batch 704, cls loss: 0.0097, label: 2,  bag_size: 13396
batch 709, cls loss: 0.3278, label: 0,  bag_size: 6430
batch 714, cls loss: 1.0203, label: 1,  bag_size: 7781
batch 719, cls loss: 0.0848, label: 0,  bag_size: 9519
batch 724, cls loss: 0.2949, label: 2,  bag_size: 4167
batch 729, cls loss: 0.2544, label: 0,  bag_size: 11701
batch 734, cls loss: 0.0913, label: 0,  bag_size: 15665
batch 739, cls loss: 0.0363, label: 2,  bag_size: 13367
batch 744, cls loss: 0.0320, label: 2,  bag_size: 9575
batch 749, cls loss: 0.2373, label: 0,  bag_size: 3461
batch 754, cls loss: 0.2903, label: 0,  bag_size: 5661
batch 759, cls loss: 1.0330, label: 0,  bag_size: 13367
batch 764, cls loss: 1.0122, label: 1,  bag_size: 2538
batch 769, cls loss: 0.0340, label: 2,  bag_size: 2677
batch 774, cls loss: 0.9774, label: 0,  bag_size: 5441
batch 779, cls loss: 0.0140, label: 2,  bag_size: 1178
batch 784, cls loss: 0.4932, label: 0,  bag_size: 10400
batch 789, cls loss: 0.1944, label: 2,  bag_size: 1597
batch 794, cls loss: 0.0500, label: 2,  bag_size: 4883
batch 799, cls loss: 4.6124, label: 1,  bag_size: 9600
batch 804, cls loss: 0.3302, label: 0,  bag_size: 2807
batch 809, cls loss: 0.1388, label: 0,  bag_size: 1999
batch 814, cls loss: 0.1513, label: 0,  bag_size: 10392
batch 819, cls loss: 1.6807, label: 1,  bag_size: 17536
batch 824, cls loss: 0.6017, label: 1,  bag_size: 5123
batch 829, cls loss: 0.7811, label: 0,  bag_size: 9561
batch 834, cls loss: 0.0673, label: 2,  bag_size: 1279
batch 839, cls loss: 0.2548, label: 2,  bag_size: 9161
batch 844, cls loss: 0.2242, label: 0,  bag_size: 4821
batch 849, cls loss: 0.0211, label: 2,  bag_size: 3229
batch 854, cls loss: 0.0380, label: 2,  bag_size: 1216
batch 859, cls loss: 0.7225, label: 1,  bag_size: 6793
batch 864, cls loss: 0.3525, label: 0,  bag_size: 17579
batch 869, cls loss: 0.3919, label: 1,  bag_size: 11288
batch 874, cls loss: 0.3140, label: 2,  bag_size: 490
batch 879, cls loss: 1.3375, label: 1,  bag_size: 3966
batch 884, cls loss: 0.3057, label: 0,  bag_size: 9258
batch 889, cls loss: 1.0326, label: 0,  bag_size: 17880
batch 894, cls loss: 0.7290, label: 0,  bag_size: 1503
batch 899, cls loss: 0.2174, label: 2,  bag_size: 7533
batch 904, cls loss: 4.2414, label: 2,  bag_size: 3593
batch 909, cls loss: 0.0531, label: 2,  bag_size: 3557
batch 914, cls loss: 1.2074, label: 0,  bag_size: 5563
batch 919, cls loss: 2.5214, label: 1,  bag_size: 5373
batch 924, cls loss: 1.8526, label: 1,  bag_size: 3149
batch 929, cls loss: 0.3771, label: 0,  bag_size: 2385
batch 934, cls loss: 0.0098, label: 2,  bag_size: 1850
batch 939, cls loss: 0.2527, label: 0,  bag_size: 12349
batch 944, cls loss: 0.3645, label: 0,  bag_size: 12946
batch 949, cls loss: 0.6251, label: 2,  bag_size: 2000
batch 954, cls loss: 1.7298, label: 1,  bag_size: 2856
batch 959, cls loss: 0.1558, label: 0,  bag_size: 8868
batch 964, cls loss: 0.5049, label: 0,  bag_size: 10622
batch 969, cls loss: 0.1070, label: 0,  bag_size: 9408
batch 974, cls loss: 0.0875, label: 2,  bag_size: 6276
batch 979, cls loss: 0.0205, label: 2,  bag_size: 3304
batch 984, cls loss: 0.3797, label: 0,  bag_size: 2146
batch 989, cls loss: 1.5305, label: 0,  bag_size: 19470
batch 994, cls loss: 0.6449, label: 1,  bag_size: 4443
batch 999, cls loss: 0.1108, label: 0,  bag_size: 5256
batch 1004, cls loss: 0.7544, label: 2,  bag_size: 17282
batch 1009, cls loss: 0.0029, label: 2,  bag_size: 1436
batch 1014, cls loss: 1.1071, label: 1,  bag_size: 17508
batch 1019, cls loss: 0.4003, label: 0,  bag_size: 3640
batch 1024, cls loss: 0.2242, label: 0,  bag_size: 12791
batch 1029, cls loss: 0.4693, label: 0,  bag_size: 4209
batch 1034, cls loss: 0.4508, label: 2,  bag_size: 4958
batch 1039, cls loss: 2.0913, label: 2,  bag_size: 2676
batch 1044, cls loss: 0.1075, label: 0,  bag_size: 1123
batch 1049, cls loss: 0.4339, label: 0,  bag_size: 12494
batch 1054, cls loss: 1.6100, label: 1,  bag_size: 4105
batch 1059, cls loss: 0.0525, label: 2,  bag_size: 1035
batch 1064, cls loss: 0.3359, label: 0,  bag_size: 1038
batch 1069, cls loss: 1.6517, label: 1,  bag_size: 1586
batch 1074, cls loss: 0.4725, label: 0,  bag_size: 21450
batch 1079, cls loss: 0.1085, label: 2,  bag_size: 3585
batch 1084, cls loss: 0.7044, label: 1,  bag_size: 3525
batch 1089, cls loss: 0.1981, label: 0,  bag_size: 5023
batch 1094, cls loss: 0.0283, label: 2,  bag_size: 2606
batch 1099, cls loss: 0.4787, label: 1,  bag_size: 2754
batch 1104, cls loss: 0.3209, label: 0,  bag_size: 4956
batch 1109, cls loss: 1.5406, label: 1,  bag_size: 9431
batch 1114, cls loss: 0.0469, label: 2,  bag_size: 14677
batch 1119, cls loss: 2.1091, label: 1,  bag_size: 11756
batch 1124, cls loss: 0.7886, label: 0,  bag_size: 6360
batch 1129, cls loss: 0.1228, label: 0,  bag_size: 6317
batch 1134, cls loss: 0.5979, label: 1,  bag_size: 2944
batch 1139, cls loss: 0.1598, label: 0,  bag_size: 1316
batch 1144, cls loss: 0.0045, label: 2,  bag_size: 5068
batch 1149, cls loss: 0.0031, label: 2,  bag_size: 2200
batch 1154, cls loss: 0.1221, label: 0,  bag_size: 7669
batch 1159, cls loss: 2.3391, label: 1,  bag_size: 10160
batch 1164, cls loss: 0.4332, label: 2,  bag_size: 6319
batch 1169, cls loss: 1.1617, label: 1,  bag_size: 3689
batch 1174, cls loss: 2.0482, label: 0,  bag_size: 1127
batch 1179, cls loss: 0.4119, label: 2,  bag_size: 8866
batch 1184, cls loss: 0.0940, label: 0,  bag_size: 684
batch 1189, cls loss: 2.4988, label: 2,  bag_size: 6282
batch 1194, cls loss: 0.0613, label: 0,  bag_size: 15093
batch 1199, cls loss: 0.0020, label: 2,  bag_size: 15502
batch 1204, cls loss: 0.8099, label: 0,  bag_size: 5231
batch 1209, cls loss: 0.2104, label: 2,  bag_size: 3865
batch 1214, cls loss: 0.4942, label: 2,  bag_size: 21007
batch 1219, cls loss: 0.3861, label: 0,  bag_size: 1649
batch 1224, cls loss: 0.2982, label: 2,  bag_size: 2793
batch 1229, cls loss: 0.4392, label: 0,  bag_size: 5160
batch 1234, cls loss: 0.6334, label: 1,  bag_size: 10670
batch 1239, cls loss: 0.2105, label: 2,  bag_size: 1728
batch 1244, cls loss: 0.8430, label: 2,  bag_size: 2593
batch 1249, cls loss: 0.3131, label: 0,  bag_size: 8040
batch 1254, cls loss: 0.2365, label: 0,  bag_size: 1525
batch 1259, cls loss: 0.2014, label: 1,  bag_size: 7156
batch 1264, cls loss: 0.1402, label: 0,  bag_size: 3437
batch 1269, cls loss: 0.0815, label: 0,  bag_size: 11195
batch 1274, cls loss: 2.3531, label: 1,  bag_size: 876
batch 1279, cls loss: 0.3615, label: 1,  bag_size: 4291
batch 1284, cls loss: 0.0819, label: 2,  bag_size: 7147
batch 1289, cls loss: 0.9165, label: 1,  bag_size: 4072
batch 1294, cls loss: 0.1610, label: 0,  bag_size: 9877
batch 1299, cls loss: 0.6174, label: 0,  bag_size: 8026
batch 1304, cls loss: 0.1018, label: 0,  bag_size: 7381
batch 1309, cls loss: 0.1567, label: 0,  bag_size: 5155
Epoch: 0, cls train_loss: 0.6799, cls train_error: 0.2922
class 0: tpr 0.8964401294498382, correct 554/618
class 1: tpr 0.21011673151750973, correct 54/257
class 2: tpr 0.7334851936218679, correct 322/439

Val Set, cls val_loss: 0.4238, cls val_error: 0.1961, cls auc: 0.9599
class 0: tpr 0.95, correct 19/20
class 1: tpr 0.1111111111111111, correct 1/9
class 2: tpr 0.9545454545454546, correct 21/22
Validation loss decreased (inf --> 0.423772).  Saving model ...


batch 4, cls loss: 0.2040, label: 0,  bag_size: 22264
batch 9, cls loss: 0.9622, label: 0,  bag_size: 2935
batch 14, cls loss: 0.0028, label: 2,  bag_size: 1083
batch 19, cls loss: 0.0702, label: 2,  bag_size: 3655
batch 24, cls loss: 0.2354, label: 0,  bag_size: 2686
batch 29, cls loss: 0.0119, label: 2,  bag_size: 2958
batch 34, cls loss: 0.0086, label: 2,  bag_size: 1651
batch 39, cls loss: 0.0770, label: 0,  bag_size: 5833
batch 44, cls loss: 0.0202, label: 2,  bag_size: 483
batch 49, cls loss: 0.3170, label: 0,  bag_size: 8410
batch 54, cls loss: 0.3261, label: 0,  bag_size: 12714
batch 59, cls loss: 0.2281, label: 0,  bag_size: 2412
batch 64, cls loss: 0.1150, label: 2,  bag_size: 5761
batch 69, cls loss: 0.9729, label: 1,  bag_size: 1701
batch 74, cls loss: 0.2436, label: 0,  bag_size: 18699
batch 79, cls loss: 0.1416, label: 0,  bag_size: 1638
batch 84, cls loss: 0.1095, label: 0,  bag_size: 21827
batch 89, cls loss: 0.0651, label: 0,  bag_size: 2638
batch 94, cls loss: 0.0037, label: 2,  bag_size: 18535
batch 99, cls loss: 0.1054, label: 0,  bag_size: 1622
batch 104, cls loss: 0.8511, label: 1,  bag_size: 966
batch 109, cls loss: 0.0085, label: 2,  bag_size: 1728
batch 114, cls loss: 0.0875, label: 0,  bag_size: 9979
batch 119, cls loss: 0.0022, label: 2,  bag_size: 1614
batch 124, cls loss: 0.1786, label: 0,  bag_size: 16379
batch 129, cls loss: 1.7766, label: 2,  bag_size: 9071
batch 134, cls loss: 0.0184, label: 2,  bag_size: 1790
batch 139, cls loss: 0.2253, label: 1,  bag_size: 7053
batch 144, cls loss: 0.0050, label: 2,  bag_size: 13726
batch 149, cls loss: 0.2879, label: 0,  bag_size: 10969
batch 154, cls loss: 0.0911, label: 0,  bag_size: 7513
batch 159, cls loss: 0.1063, label: 0,  bag_size: 12697
batch 164, cls loss: 0.5678, label: 2,  bag_size: 3086
batch 169, cls loss: 1.9802, label: 2,  bag_size: 9154
batch 174, cls loss: 0.0165, label: 2,  bag_size: 1150
batch 179, cls loss: 0.0586, label: 1,  bag_size: 2912
batch 184, cls loss: 0.1847, label: 2,  bag_size: 2000
batch 189, cls loss: 0.0263, label: 0,  bag_size: 8448
batch 194, cls loss: 0.0149, label: 2,  bag_size: 11212
batch 199, cls loss: 1.0916, label: 1,  bag_size: 3741
batch 204, cls loss: 0.6407, label: 1,  bag_size: 2382
batch 209, cls loss: 0.0394, label: 0,  bag_size: 1252
batch 214, cls loss: 0.7686, label: 0,  bag_size: 12348
batch 219, cls loss: 0.0030, label: 2,  bag_size: 3229
batch 224, cls loss: 0.0345, label: 0,  bag_size: 10281
batch 229, cls loss: 0.1210, label: 0,  bag_size: 3683
batch 234, cls loss: 0.0740, label: 0,  bag_size: 19606
batch 239, cls loss: 0.2757, label: 0,  bag_size: 4323
batch 244, cls loss: 0.5036, label: 1,  bag_size: 6661
batch 249, cls loss: 0.1307, label: 1,  bag_size: 9121
batch 254, cls loss: 0.0493, label: 2,  bag_size: 3332
batch 259, cls loss: 1.7759, label: 0,  bag_size: 20870
batch 264, cls loss: 0.5015, label: 0,  bag_size: 9587
batch 269, cls loss: 0.0439, label: 2,  bag_size: 6522
batch 274, cls loss: 0.9888, label: 1,  bag_size: 5727
batch 279, cls loss: 1.4632, label: 1,  bag_size: 3689
batch 284, cls loss: 0.0895, label: 0,  bag_size: 6769
batch 289, cls loss: 0.2505, label: 0,  bag_size: 9942
batch 294, cls loss: 0.3982, label: 1,  bag_size: 977
batch 299, cls loss: 1.5593, label: 0,  bag_size: 1919
batch 304, cls loss: 0.4585, label: 0,  bag_size: 7989
batch 309, cls loss: 0.0612, label: 0,  bag_size: 3937
batch 314, cls loss: 0.2787, label: 2,  bag_size: 14909
batch 319, cls loss: 0.0040, label: 2,  bag_size: 3816
batch 324, cls loss: 0.0540, label: 0,  bag_size: 3968
batch 329, cls loss: 0.9048, label: 0,  bag_size: 6639
batch 334, cls loss: 0.0731, label: 0,  bag_size: 1823
batch 339, cls loss: 0.2583, label: 0,  bag_size: 1051
batch 344, cls loss: 1.8928, label: 1,  bag_size: 13362
batch 349, cls loss: 0.0551, label: 0,  bag_size: 2140
batch 354, cls loss: 0.2771, label: 1,  bag_size: 6411
batch 359, cls loss: 0.1931, label: 0,  bag_size: 2814
batch 364, cls loss: 0.0024, label: 2,  bag_size: 21899
batch 369, cls loss: 0.5626, label: 2,  bag_size: 14765
batch 374, cls loss: 2.0000, label: 1,  bag_size: 17536
batch 379, cls loss: 1.7955, label: 1,  bag_size: 19129
batch 384, cls loss: 0.7236, label: 0,  bag_size: 3461
batch 389, cls loss: 0.3450, label: 1,  bag_size: 1177
batch 394, cls loss: 1.9456, label: 0,  bag_size: 14538
batch 399, cls loss: 0.4893, label: 0,  bag_size: 3540
batch 404, cls loss: 0.2881, label: 1,  bag_size: 5704
batch 409, cls loss: 0.4907, label: 2,  bag_size: 7082
batch 414, cls loss: 0.2447, label: 2,  bag_size: 3227
batch 419, cls loss: 0.3130, label: 0,  bag_size: 12180
batch 424, cls loss: 0.9764, label: 0,  bag_size: 1236
batch 429, cls loss: 0.0006, label: 2,  bag_size: 14092
batch 434, cls loss: 0.2671, label: 0,  bag_size: 9689
batch 439, cls loss: 0.2330, label: 0,  bag_size: 12801
batch 444, cls loss: 0.0018, label: 2,  bag_size: 10298
batch 449, cls loss: 0.2718, label: 0,  bag_size: 7767
batch 454, cls loss: 1.6631, label: 1,  bag_size: 4098
batch 459, cls loss: 0.2586, label: 0,  bag_size: 13861
batch 464, cls loss: 0.2791, label: 0,  bag_size: 19866
batch 469, cls loss: 0.0157, label: 2,  bag_size: 9575
batch 474, cls loss: 0.9932, label: 2,  bag_size: 3865
batch 479, cls loss: 0.0032, label: 2,  bag_size: 2065
batch 484, cls loss: 2.3198, label: 1,  bag_size: 4620
batch 489, cls loss: 0.0031, label: 2,  bag_size: 6454
batch 494, cls loss: 1.0960, label: 1,  bag_size: 3690
batch 499, cls loss: 0.0203, label: 2,  bag_size: 2061
batch 504, cls loss: 0.0478, label: 2,  bag_size: 14711
batch 509, cls loss: 0.1743, label: 1,  bag_size: 10670
batch 514, cls loss: 0.6526, label: 0,  bag_size: 19470
batch 519, cls loss: 0.7122, label: 1,  bag_size: 6411
batch 524, cls loss: 0.2895, label: 0,  bag_size: 1191
batch 529, cls loss: 0.1070, label: 0,  bag_size: 28527
batch 534, cls loss: 0.3137, label: 1,  bag_size: 881
batch 539, cls loss: 0.0937, label: 0,  bag_size: 1776
batch 544, cls loss: 2.3978, label: 2,  bag_size: 4282
batch 549, cls loss: 0.1144, label: 1,  bag_size: 3461
batch 554, cls loss: 1.0660, label: 1,  bag_size: 3525
batch 559, cls loss: 0.0038, label: 2,  bag_size: 12170
batch 564, cls loss: 0.3084, label: 0,  bag_size: 8602
batch 569, cls loss: 0.3334, label: 0,  bag_size: 4394
batch 574, cls loss: 0.0226, label: 2,  bag_size: 2068
batch 579, cls loss: 0.0022, label: 2,  bag_size: 1035
batch 584, cls loss: 0.0164, label: 2,  bag_size: 6320
batch 589, cls loss: 0.0003, label: 2,  bag_size: 2278
batch 594, cls loss: 0.0069, label: 2,  bag_size: 1681
batch 599, cls loss: 0.2752, label: 0,  bag_size: 3803
batch 604, cls loss: 0.8708, label: 1,  bag_size: 3255
batch 609, cls loss: 0.0934, label: 2,  bag_size: 19220
batch 614, cls loss: 1.9604, label: 1,  bag_size: 1409
batch 619, cls loss: 0.2646, label: 0,  bag_size: 6776
batch 624, cls loss: 0.6949, label: 1,  bag_size: 5123
batch 629, cls loss: 0.2566, label: 0,  bag_size: 4188
batch 634, cls loss: 0.0720, label: 0,  bag_size: 9280
batch 639, cls loss: 0.0967, label: 0,  bag_size: 9547
batch 644, cls loss: 0.2006, label: 0,  bag_size: 1963
batch 649, cls loss: 0.0009, label: 2,  bag_size: 3278
batch 654, cls loss: 0.0381, label: 2,  bag_size: 732
batch 659, cls loss: 2.2694, label: 2,  bag_size: 7810
batch 664, cls loss: 0.3903, label: 1,  bag_size: 2590
batch 669, cls loss: 0.0011, label: 2,  bag_size: 3086
batch 674, cls loss: 0.2617, label: 0,  bag_size: 3567
batch 679, cls loss: 0.3407, label: 0,  bag_size: 3818
batch 684, cls loss: 0.1540, label: 0,  bag_size: 16267
batch 689, cls loss: 0.0029, label: 2,  bag_size: 25160
batch 694, cls loss: 0.6050, label: 0,  bag_size: 7110
batch 699, cls loss: 0.6732, label: 0,  bag_size: 3685
batch 704, cls loss: 2.3609, label: 1,  bag_size: 3110
batch 709, cls loss: 0.0008, label: 2,  bag_size: 4321
batch 714, cls loss: 0.0004, label: 2,  bag_size: 7071
batch 719, cls loss: 0.3471, label: 0,  bag_size: 10501
batch 724, cls loss: 0.1249, label: 0,  bag_size: 2779
batch 729, cls loss: 0.0158, label: 2,  bag_size: 575
batch 734, cls loss: 1.0805, label: 1,  bag_size: 2856
batch 739, cls loss: 0.0197, label: 2,  bag_size: 6439
batch 744, cls loss: 1.5052, label: 0,  bag_size: 10438
batch 749, cls loss: 0.0973, label: 0,  bag_size: 6250
batch 754, cls loss: 0.0467, label: 0,  bag_size: 13692
batch 759, cls loss: 0.0140, label: 1,  bag_size: 7248
batch 764, cls loss: 0.6394, label: 1,  bag_size: 2545
batch 769, cls loss: 0.0731, label: 0,  bag_size: 5163
batch 774, cls loss: 0.1653, label: 0,  bag_size: 12460
batch 779, cls loss: 0.1763, label: 1,  bag_size: 3376
batch 784, cls loss: 2.1238, label: 1,  bag_size: 3425
batch 789, cls loss: 0.0312, label: 2,  bag_size: 9157
batch 794, cls loss: 0.0225, label: 2,  bag_size: 3435
batch 799, cls loss: 0.1434, label: 2,  bag_size: 6015
batch 804, cls loss: 0.7382, label: 2,  bag_size: 2379
batch 809, cls loss: 0.0022, label: 2,  bag_size: 4419
batch 814, cls loss: 0.1468, label: 2,  bag_size: 14852
batch 819, cls loss: 0.1094, label: 0,  bag_size: 8012
batch 824, cls loss: 0.0015, label: 2,  bag_size: 12325
batch 829, cls loss: 0.2833, label: 0,  bag_size: 1845
batch 834, cls loss: 0.0993, label: 0,  bag_size: 5864
batch 839, cls loss: 0.0406, label: 2,  bag_size: 1857
batch 844, cls loss: 0.1710, label: 2,  bag_size: 15033
batch 849, cls loss: 1.1602, label: 1,  bag_size: 3941
batch 854, cls loss: 1.8497, label: 0,  bag_size: 7119
batch 859, cls loss: 0.0008, label: 2,  bag_size: 1505
batch 864, cls loss: 1.3796, label: 1,  bag_size: 1940
batch 869, cls loss: 0.4237, label: 1,  bag_size: 1664
batch 874, cls loss: 0.2426, label: 0,  bag_size: 11174
batch 879, cls loss: 0.1418, label: 0,  bag_size: 10112
batch 884, cls loss: 0.0016, label: 2,  bag_size: 2755
batch 889, cls loss: 0.5513, label: 0,  bag_size: 3549
batch 894, cls loss: 0.8410, label: 1,  bag_size: 3218
batch 899, cls loss: 0.3448, label: 1,  bag_size: 7085
batch 904, cls loss: 0.0018, label: 2,  bag_size: 1279
batch 909, cls loss: 0.0973, label: 0,  bag_size: 5661
batch 914, cls loss: 1.1394, label: 1,  bag_size: 7509
batch 919, cls loss: 0.1120, label: 0,  bag_size: 12946
batch 924, cls loss: 0.1289, label: 0,  bag_size: 4375
batch 929, cls loss: 0.2241, label: 0,  bag_size: 8040
batch 934, cls loss: 0.0031, label: 2,  bag_size: 6045
batch 939, cls loss: 0.0377, label: 1,  bag_size: 5726
batch 944, cls loss: 0.2464, label: 0,  bag_size: 6205
batch 949, cls loss: 0.0827, label: 1,  bag_size: 3347
batch 954, cls loss: 2.0019, label: 1,  bag_size: 3467
batch 959, cls loss: 0.0786, label: 0,  bag_size: 9913
batch 964, cls loss: 0.0985, label: 0,  bag_size: 5965
batch 969, cls loss: 0.0465, label: 1,  bag_size: 1874
batch 974, cls loss: 0.4009, label: 0,  bag_size: 15192
batch 979, cls loss: 0.2161, label: 0,  bag_size: 9983
batch 984, cls loss: 4.3133, label: 1,  bag_size: 3872
batch 989, cls loss: 0.2521, label: 2,  bag_size: 2582
batch 994, cls loss: 0.0023, label: 2,  bag_size: 4189
batch 999, cls loss: 0.1373, label: 1,  bag_size: 8588
batch 1004, cls loss: 0.0083, label: 2,  bag_size: 3655
batch 1009, cls loss: 0.0077, label: 2,  bag_size: 500
batch 1014, cls loss: 0.0046, label: 2,  bag_size: 6181
batch 1019, cls loss: 0.2712, label: 1,  bag_size: 5452
batch 1024, cls loss: 0.3493, label: 1,  bag_size: 3541
batch 1029, cls loss: 0.1531, label: 0,  bag_size: 4365
batch 1034, cls loss: 0.0110, label: 2,  bag_size: 2966
batch 1039, cls loss: 0.2868, label: 0,  bag_size: 1242
batch 1044, cls loss: 0.0111, label: 2,  bag_size: 4227
batch 1049, cls loss: 0.0647, label: 2,  bag_size: 6257
batch 1054, cls loss: 0.0006, label: 2,  bag_size: 2244
batch 1059, cls loss: 0.0033, label: 2,  bag_size: 2511
batch 1064, cls loss: 0.1516, label: 0,  bag_size: 2455
batch 1069, cls loss: 0.1700, label: 0,  bag_size: 6090
batch 1074, cls loss: 0.5109, label: 2,  bag_size: 1702
batch 1079, cls loss: 0.6588, label: 1,  bag_size: 989
batch 1084, cls loss: 0.0005, label: 2,  bag_size: 2949
batch 1089, cls loss: 0.0201, label: 1,  bag_size: 2491
batch 1094, cls loss: 0.2065, label: 0,  bag_size: 11389
batch 1099, cls loss: 2.4814, label: 2,  bag_size: 3956
batch 1104, cls loss: 0.0115, label: 1,  bag_size: 8939
batch 1109, cls loss: 0.9341, label: 1,  bag_size: 2986
batch 1114, cls loss: 0.0012, label: 2,  bag_size: 5068
batch 1119, cls loss: 0.0750, label: 2,  bag_size: 17087
batch 1124, cls loss: 0.0181, label: 2,  bag_size: 8687
batch 1129, cls loss: 1.4699, label: 1,  bag_size: 12684
batch 1134, cls loss: 0.0979, label: 0,  bag_size: 4102
batch 1139, cls loss: 0.8450, label: 1,  bag_size: 2944
batch 1144, cls loss: 0.2696, label: 1,  bag_size: 5459
batch 1149, cls loss: 0.0242, label: 1,  bag_size: 5492
batch 1154, cls loss: 0.0319, label: 2,  bag_size: 7309
batch 1159, cls loss: 0.3473, label: 0,  bag_size: 9955
batch 1164, cls loss: 0.0802, label: 0,  bag_size: 10033
batch 1169, cls loss: 0.0097, label: 2,  bag_size: 2117
batch 1174, cls loss: 0.0232, label: 2,  bag_size: 3889
batch 1179, cls loss: 0.0600, label: 0,  bag_size: 2678
batch 1184, cls loss: 0.2444, label: 1,  bag_size: 2102
batch 1189, cls loss: 1.8783, label: 1,  bag_size: 13919
batch 1194, cls loss: 0.2579, label: 2,  bag_size: 4513
batch 1199, cls loss: 0.5298, label: 0,  bag_size: 9747
batch 1204, cls loss: 0.0686, label: 0,  bag_size: 10966
batch 1209, cls loss: 0.5724, label: 2,  bag_size: 8383
batch 1214, cls loss: 0.0893, label: 0,  bag_size: 1764
batch 1219, cls loss: 0.0468, label: 0,  bag_size: 15213
batch 1224, cls loss: 0.0028, label: 2,  bag_size: 12594
batch 1229, cls loss: 0.0988, label: 0,  bag_size: 12895
batch 1234, cls loss: 0.5474, label: 2,  bag_size: 10341
batch 1239, cls loss: 0.0649, label: 0,  bag_size: 9644
batch 1244, cls loss: 0.1144, label: 0,  bag_size: 3368
batch 1249, cls loss: 0.7194, label: 2,  bag_size: 6319
batch 1254, cls loss: 0.4650, label: 0,  bag_size: 12575
batch 1259, cls loss: 0.0216, label: 0,  bag_size: 6927
batch 1264, cls loss: 0.0218, label: 2,  bag_size: 3738
batch 1269, cls loss: 0.0513, label: 0,  bag_size: 7515
batch 1274, cls loss: 0.0387, label: 1,  bag_size: 2403
batch 1279, cls loss: 0.0097, label: 2,  bag_size: 6132
batch 1284, cls loss: 0.3142, label: 0,  bag_size: 17880
batch 1289, cls loss: 0.0119, label: 0,  bag_size: 1123
batch 1294, cls loss: 0.0047, label: 2,  bag_size: 1344
batch 1299, cls loss: 0.0519, label: 0,  bag_size: 7445
batch 1304, cls loss: 0.1317, label: 1,  bag_size: 917
batch 1309, cls loss: 0.0968, label: 0,  bag_size: 6164
Epoch: 1, cls train_loss: 0.3987, cls train_error: 0.1522
class 0: tpr 0.9320388349514563, correct 576/618
class 1: tpr 0.5097276264591439, correct 131/257
class 2: tpr 0.9271070615034168, correct 407/439

Val Set, cls val_loss: 0.3384, cls val_error: 0.0784, cls auc: 0.9661
class 0: tpr 1.0, correct 20/20
class 1: tpr 0.7777777777777778, correct 7/9
class 2: tpr 0.9090909090909091, correct 20/22
Validation loss decreased (0.423772 --> 0.338368).  Saving model ...


batch 4, cls loss: 0.0181, label: 2,  bag_size: 2104
batch 9, cls loss: 0.2703, label: 1,  bag_size: 3525
batch 14, cls loss: 0.0751, label: 0,  bag_size: 2179
batch 19, cls loss: 0.1527, label: 0,  bag_size: 1888
batch 24, cls loss: 0.1921, label: 0,  bag_size: 16703
batch 29, cls loss: 0.0004, label: 2,  bag_size: 1824
batch 34, cls loss: 0.3593, label: 0,  bag_size: 12697
batch 39, cls loss: 0.0469, label: 0,  bag_size: 15008
batch 44, cls loss: 2.8721, label: 1,  bag_size: 13616
batch 49, cls loss: 0.0001, label: 2,  bag_size: 10559
batch 54, cls loss: 0.0006, label: 2,  bag_size: 2160
batch 59, cls loss: 0.0071, label: 2,  bag_size: 4088
batch 64, cls loss: 0.2638, label: 1,  bag_size: 4105
batch 69, cls loss: 0.4573, label: 0,  bag_size: 17880
batch 74, cls loss: 0.0512, label: 0,  bag_size: 4877
batch 79, cls loss: 2.4378, label: 1,  bag_size: 1452
batch 84, cls loss: 0.0818, label: 0,  bag_size: 1743
batch 89, cls loss: 0.1763, label: 2,  bag_size: 1608
batch 94, cls loss: 0.1653, label: 2,  bag_size: 16275
batch 99, cls loss: 0.0262, label: 0,  bag_size: 17769
batch 104, cls loss: 0.0296, label: 0,  bag_size: 6752
batch 109, cls loss: 0.0413, label: 0,  bag_size: 6269
batch 114, cls loss: 0.0083, label: 2,  bag_size: 10345
batch 119, cls loss: 0.0936, label: 0,  bag_size: 3306
batch 124, cls loss: 0.2049, label: 2,  bag_size: 3882
batch 129, cls loss: 0.0030, label: 2,  bag_size: 3357
batch 134, cls loss: 0.0388, label: 0,  bag_size: 11195
batch 139, cls loss: 0.0082, label: 2,  bag_size: 17282
batch 144, cls loss: 0.0002, label: 2,  bag_size: 4321
batch 149, cls loss: 0.0463, label: 0,  bag_size: 5965
batch 154, cls loss: 1.0855, label: 1,  bag_size: 9925
batch 159, cls loss: 0.0108, label: 1,  bag_size: 3730
batch 164, cls loss: 0.0005, label: 2,  bag_size: 1763
batch 169, cls loss: 1.6033, label: 1,  bag_size: 4842
batch 174, cls loss: 0.1994, label: 1,  bag_size: 9751
batch 179, cls loss: 0.0006, label: 2,  bag_size: 3079
batch 184, cls loss: 0.5913, label: 1,  bag_size: 803
batch 189, cls loss: 0.0001, label: 2,  bag_size: 9383
batch 194, cls loss: 0.4584, label: 0,  bag_size: 1360
batch 199, cls loss: 0.4912, label: 0,  bag_size: 9162
batch 204, cls loss: 0.0513, label: 0,  bag_size: 3437
batch 209, cls loss: 0.0506, label: 0,  bag_size: 1819
batch 214, cls loss: 2.5172, label: 1,  bag_size: 9431
batch 219, cls loss: 0.1925, label: 1,  bag_size: 3338
batch 224, cls loss: 0.1194, label: 0,  bag_size: 1924
batch 229, cls loss: 0.4073, label: 0,  bag_size: 11386
batch 234, cls loss: 0.0107, label: 1,  bag_size: 2511
batch 239, cls loss: 0.0166, label: 2,  bag_size: 14475
batch 244, cls loss: 0.0460, label: 0,  bag_size: 5256
batch 249, cls loss: 0.1133, label: 0,  bag_size: 19606
batch 254, cls loss: 0.3381, label: 0,  bag_size: 1875
batch 259, cls loss: 0.0293, label: 2,  bag_size: 6282
batch 264, cls loss: 0.7228, label: 2,  bag_size: 3956
batch 269, cls loss: 0.0001, label: 2,  bag_size: 1776
batch 274, cls loss: 0.0398, label: 2,  bag_size: 1649
batch 279, cls loss: 0.1655, label: 0,  bag_size: 4939
batch 284, cls loss: 0.0926, label: 0,  bag_size: 4128
batch 289, cls loss: 0.0277, label: 2,  bag_size: 7147
batch 294, cls loss: 0.0015, label: 2,  bag_size: 1784
batch 299, cls loss: 0.6171, label: 2,  bag_size: 4583
batch 304, cls loss: 0.2898, label: 1,  bag_size: 3740
batch 309, cls loss: 0.2883, label: 0,  bag_size: 10969
batch 314, cls loss: 0.1015, label: 0,  bag_size: 11389
batch 319, cls loss: 0.6544, label: 0,  bag_size: 11256
batch 324, cls loss: 0.0476, label: 0,  bag_size: 9393
batch 329, cls loss: 0.0142, label: 0,  bag_size: 10392
batch 334, cls loss: 0.0137, label: 0,  bag_size: 3450
batch 339, cls loss: 0.0423, label: 1,  bag_size: 11288
batch 344, cls loss: 0.0876, label: 0,  bag_size: 3801
batch 349, cls loss: 0.0005, label: 2,  bag_size: 2496
batch 354, cls loss: 0.3501, label: 0,  bag_size: 7798
batch 359, cls loss: 0.0095, label: 2,  bag_size: 8687
batch 364, cls loss: 0.5999, label: 2,  bag_size: 1012
batch 369, cls loss: 0.0162, label: 0,  bag_size: 645
batch 374, cls loss: 0.2666, label: 2,  bag_size: 5021
batch 379, cls loss: 0.0309, label: 1,  bag_size: 3359
batch 384, cls loss: 0.3304, label: 1,  bag_size: 6411
batch 389, cls loss: 0.1506, label: 0,  bag_size: 13255
batch 394, cls loss: 0.1189, label: 0,  bag_size: 3082
batch 399, cls loss: 0.2256, label: 0,  bag_size: 1622
batch 404, cls loss: 0.0654, label: 0,  bag_size: 1022
batch 409, cls loss: 0.0418, label: 0,  bag_size: 1230
batch 414, cls loss: 0.1088, label: 0,  bag_size: 6250
batch 419, cls loss: 0.0356, label: 1,  bag_size: 7781
batch 424, cls loss: 0.0477, label: 0,  bag_size: 16154
batch 429, cls loss: 5.3403, label: 2,  bag_size: 3593
batch 434, cls loss: 0.0274, label: 0,  bag_size: 5690
batch 439, cls loss: 0.1039, label: 0,  bag_size: 14230
batch 444, cls loss: 0.0003, label: 2,  bag_size: 1850
batch 449, cls loss: 1.3475, label: 0,  bag_size: 6481
batch 454, cls loss: 0.0020, label: 1,  bag_size: 8759
batch 459, cls loss: 2.9579, label: 2,  bag_size: 1702
batch 464, cls loss: 0.0596, label: 2,  bag_size: 800
batch 469, cls loss: 0.0650, label: 0,  bag_size: 8602
batch 474, cls loss: 0.0156, label: 2,  bag_size: 3084
batch 479, cls loss: 0.1975, label: 2,  bag_size: 6452
batch 484, cls loss: 0.1613, label: 2,  bag_size: 1023
batch 489, cls loss: 0.1253, label: 0,  bag_size: 8660
batch 494, cls loss: 0.1490, label: 0,  bag_size: 4394
batch 499, cls loss: 0.0635, label: 1,  bag_size: 9173
batch 504, cls loss: 0.1141, label: 1,  bag_size: 1874
batch 509, cls loss: 0.1308, label: 0,  bag_size: 2848
batch 514, cls loss: 0.1528, label: 1,  bag_size: 9684
batch 519, cls loss: 0.0373, label: 2,  bag_size: 3227
batch 524, cls loss: 0.1762, label: 0,  bag_size: 10848
batch 529, cls loss: 0.1652, label: 0,  bag_size: 13026
batch 534, cls loss: 0.0774, label: 0,  bag_size: 10169
batch 539, cls loss: 0.0095, label: 2,  bag_size: 10909
batch 544, cls loss: 0.1358, label: 2,  bag_size: 6320
batch 549, cls loss: 0.0458, label: 0,  bag_size: 2904
batch 554, cls loss: 0.0643, label: 2,  bag_size: 2000
batch 559, cls loss: 0.1427, label: 0,  bag_size: 7246
batch 564, cls loss: 0.0620, label: 0,  bag_size: 12394
batch 569, cls loss: 0.8216, label: 1,  bag_size: 4732
batch 574, cls loss: 0.1424, label: 2,  bag_size: 3261
batch 579, cls loss: 0.0144, label: 2,  bag_size: 4613
batch 584, cls loss: 1.4067, label: 2,  bag_size: 5597
batch 589, cls loss: 0.0070, label: 2,  bag_size: 8194
batch 594, cls loss: 0.0012, label: 2,  bag_size: 13622
batch 599, cls loss: 0.7858, label: 0,  bag_size: 5025
batch 604, cls loss: 0.0943, label: 0,  bag_size: 5921
batch 609, cls loss: 2.2406, label: 1,  bag_size: 8222
batch 614, cls loss: 0.1258, label: 2,  bag_size: 3332
batch 619, cls loss: 0.1041, label: 0,  bag_size: 15192
batch 624, cls loss: 0.0762, label: 0,  bag_size: 14887
batch 629, cls loss: 0.0380, label: 0,  bag_size: 8419
batch 634, cls loss: 0.5356, label: 1,  bag_size: 876
batch 639, cls loss: 0.1059, label: 0,  bag_size: 13972
batch 644, cls loss: 0.1118, label: 2,  bag_size: 1479
batch 649, cls loss: 0.1108, label: 0,  bag_size: 6875
batch 654, cls loss: 1.0285, label: 0,  bag_size: 2565
batch 659, cls loss: 0.0011, label: 2,  bag_size: 809
batch 664, cls loss: 0.1307, label: 0,  bag_size: 3674
batch 669, cls loss: 4.9986, label: 2,  bag_size: 7216
batch 674, cls loss: 0.1172, label: 1,  bag_size: 1863
batch 679, cls loss: 0.0654, label: 0,  bag_size: 8448
batch 684, cls loss: 0.0238, label: 2,  bag_size: 2932
batch 689, cls loss: 0.0032, label: 2,  bag_size: 1166
batch 694, cls loss: 0.0399, label: 0,  bag_size: 9065
batch 699, cls loss: 0.2710, label: 2,  bag_size: 13786
batch 704, cls loss: 0.2247, label: 0,  bag_size: 9215
batch 709, cls loss: 0.1606, label: 0,  bag_size: 7806
batch 714, cls loss: 0.4454, label: 2,  bag_size: 5067
batch 719, cls loss: 0.0815, label: 0,  bag_size: 9689
batch 724, cls loss: 0.3077, label: 1,  bag_size: 2538
batch 729, cls loss: 0.0604, label: 0,  bag_size: 1101
batch 734, cls loss: 0.0002, label: 2,  bag_size: 4881
batch 739, cls loss: 0.4145, label: 2,  bag_size: 9034
batch 744, cls loss: 0.0560, label: 2,  bag_size: 9412
batch 749, cls loss: 0.0006, label: 2,  bag_size: 4618
batch 754, cls loss: 0.0639, label: 2,  bag_size: 2676
batch 759, cls loss: 1.5765, label: 1,  bag_size: 4098
batch 764, cls loss: 1.0054, label: 0,  bag_size: 12719
batch 769, cls loss: 0.2923, label: 0,  bag_size: 7583
batch 774, cls loss: 0.6314, label: 0,  bag_size: 1533
batch 779, cls loss: 0.0588, label: 0,  bag_size: 10394
batch 784, cls loss: 0.6046, label: 1,  bag_size: 4072
batch 789, cls loss: 0.0036, label: 2,  bag_size: 3706
batch 794, cls loss: 0.0858, label: 0,  bag_size: 3937
batch 799, cls loss: 0.2019, label: 0,  bag_size: 5494
batch 804, cls loss: 0.2178, label: 0,  bag_size: 9955
batch 809, cls loss: 0.0173, label: 0,  bag_size: 621
batch 814, cls loss: 0.0606, label: 0,  bag_size: 7935
batch 819, cls loss: 0.0356, label: 0,  bag_size: 9877
batch 824, cls loss: 0.0766, label: 0,  bag_size: 9571
batch 829, cls loss: 0.6442, label: 0,  bag_size: 1755
batch 834, cls loss: 0.0154, label: 2,  bag_size: 6064
batch 839, cls loss: 0.0740, label: 0,  bag_size: 7989
batch 844, cls loss: 2.0397, label: 2,  bag_size: 1427
batch 849, cls loss: 0.0784, label: 1,  bag_size: 1940
batch 854, cls loss: 0.0633, label: 0,  bag_size: 14618
batch 859, cls loss: 0.0294, label: 0,  bag_size: 1172
batch 864, cls loss: 0.0714, label: 0,  bag_size: 6966
batch 869, cls loss: 0.2384, label: 0,  bag_size: 9321
batch 874, cls loss: 0.0155, label: 0,  bag_size: 6752
batch 879, cls loss: 0.0340, label: 0,  bag_size: 28527
batch 884, cls loss: 0.0193, label: 0,  bag_size: 5690
batch 889, cls loss: 0.0872, label: 2,  bag_size: 6439
batch 894, cls loss: 0.8721, label: 0,  bag_size: 11566
batch 899, cls loss: 0.0672, label: 2,  bag_size: 4958
batch 904, cls loss: 0.0011, label: 2,  bag_size: 7305
batch 909, cls loss: 0.0099, label: 1,  bag_size: 5452
batch 914, cls loss: 0.0000, label: 2,  bag_size: 8886
batch 919, cls loss: 0.2693, label: 0,  bag_size: 3803
batch 924, cls loss: 0.5614, label: 0,  bag_size: 2323
batch 929, cls loss: 0.0396, label: 0,  bag_size: 2681
batch 934, cls loss: 0.0107, label: 2,  bag_size: 2606
batch 939, cls loss: 0.0120, label: 0,  bag_size: 5526
batch 944, cls loss: 0.0259, label: 0,  bag_size: 6192
batch 949, cls loss: 0.2025, label: 0,  bag_size: 12349
batch 954, cls loss: 1.9426, label: 0,  bag_size: 20354
batch 959, cls loss: 0.1129, label: 0,  bag_size: 1051
batch 964, cls loss: 0.0002, label: 2,  bag_size: 2755
batch 969, cls loss: 0.0154, label: 0,  bag_size: 1165
batch 974, cls loss: 0.3222, label: 2,  bag_size: 1537
batch 979, cls loss: 3.0951, label: 1,  bag_size: 3643
batch 984, cls loss: 0.0402, label: 1,  bag_size: 4811
batch 989, cls loss: 0.0295, label: 0,  bag_size: 10437
batch 994, cls loss: 0.0690, label: 0,  bag_size: 2480
batch 999, cls loss: 0.0033, label: 2,  bag_size: 2225
batch 1004, cls loss: 0.0012, label: 2,  bag_size: 3655
batch 1009, cls loss: 1.0562, label: 1,  bag_size: 4477
batch 1014, cls loss: 0.4139, label: 0,  bag_size: 2098
batch 1019, cls loss: 0.0894, label: 0,  bag_size: 15332
batch 1024, cls loss: 0.1337, label: 0,  bag_size: 1845
batch 1029, cls loss: 0.4063, label: 0,  bag_size: 4423
batch 1034, cls loss: 0.3052, label: 0,  bag_size: 4929
batch 1039, cls loss: 0.0647, label: 2,  bag_size: 12753
batch 1044, cls loss: 0.7087, label: 1,  bag_size: 1138
batch 1049, cls loss: 0.0628, label: 2,  bag_size: 1462
batch 1054, cls loss: 0.0012, label: 2,  bag_size: 18535
batch 1059, cls loss: 0.0812, label: 2,  bag_size: 11901
batch 1064, cls loss: 0.0508, label: 2,  bag_size: 13184
batch 1069, cls loss: 0.5031, label: 0,  bag_size: 13051
batch 1074, cls loss: 0.0009, label: 2,  bag_size: 13726
batch 1079, cls loss: 0.4523, label: 0,  bag_size: 1015
batch 1084, cls loss: 0.0015, label: 2,  bag_size: 3304
batch 1089, cls loss: 0.0148, label: 2,  bag_size: 8802
batch 1094, cls loss: 0.0425, label: 2,  bag_size: 13766
batch 1099, cls loss: 0.0834, label: 0,  bag_size: 689
batch 1104, cls loss: 0.0517, label: 1,  bag_size: 1034
batch 1109, cls loss: 0.2414, label: 2,  bag_size: 1733
batch 1114, cls loss: 0.0298, label: 0,  bag_size: 4375
batch 1119, cls loss: 0.1117, label: 1,  bag_size: 3701
batch 1124, cls loss: 0.0001, label: 2,  bag_size: 3542
batch 1129, cls loss: 1.1465, label: 1,  bag_size: 7085
batch 1134, cls loss: 0.0492, label: 1,  bag_size: 1082
batch 1139, cls loss: 5.9674, label: 0,  bag_size: 8359
batch 1144, cls loss: 0.0038, label: 1,  bag_size: 9911
batch 1149, cls loss: 0.0033, label: 1,  bag_size: 8588
batch 1154, cls loss: 0.0453, label: 0,  bag_size: 9280
batch 1159, cls loss: 0.0419, label: 2,  bag_size: 4940
batch 1164, cls loss: 0.0645, label: 0,  bag_size: 5629
batch 1169, cls loss: 0.0041, label: 2,  bag_size: 1474
batch 1174, cls loss: 0.0008, label: 2,  bag_size: 5658
batch 1179, cls loss: 0.0811, label: 0,  bag_size: 9330
batch 1184, cls loss: 0.0488, label: 0,  bag_size: 13692
batch 1189, cls loss: 0.0002, label: 2,  bag_size: 11853
batch 1194, cls loss: 0.0091, label: 2,  bag_size: 6625
batch 1199, cls loss: 0.0879, label: 1,  bag_size: 7136
batch 1204, cls loss: 0.0002, label: 2,  bag_size: 9600
batch 1209, cls loss: 2.1561, label: 1,  bag_size: 3973
batch 1214, cls loss: 0.0014, label: 2,  bag_size: 1150
batch 1219, cls loss: 0.0021, label: 1,  bag_size: 2403
batch 1224, cls loss: 0.0065, label: 2,  bag_size: 11961
batch 1229, cls loss: 0.2262, label: 0,  bag_size: 2955
batch 1234, cls loss: 0.6374, label: 1,  bag_size: 1654
batch 1239, cls loss: 0.5066, label: 0,  bag_size: 7888
batch 1244, cls loss: 0.0356, label: 2,  bag_size: 4823
batch 1249, cls loss: 0.0000, label: 2,  bag_size: 18541
batch 1254, cls loss: 0.1845, label: 1,  bag_size: 4443
batch 1259, cls loss: 0.0222, label: 0,  bag_size: 17486
batch 1264, cls loss: 0.0444, label: 0,  bag_size: 8868
batch 1269, cls loss: 0.5057, label: 1,  bag_size: 2590
batch 1274, cls loss: 0.0606, label: 0,  bag_size: 10588
batch 1279, cls loss: 0.0749, label: 0,  bag_size: 9297
batch 1284, cls loss: 0.1791, label: 1,  bag_size: 1102
batch 1289, cls loss: 0.0011, label: 2,  bag_size: 1728
batch 1294, cls loss: 0.2277, label: 1,  bag_size: 3194
batch 1299, cls loss: 0.8642, label: 0,  bag_size: 4822
batch 1304, cls loss: 0.6539, label: 1,  bag_size: 11756
batch 1309, cls loss: 0.4066, label: 0,  bag_size: 9732
Epoch: 2, cls train_loss: 0.3351, cls train_error: 0.1301
class 0: tpr 0.9271844660194175, correct 573/618











batch 4, cls loss: 0.0000, label: 0,  bag_size: 3450
batch 9, cls loss: 0.0003, label: 2,  bag_size: 9233
batch 14, cls loss: 0.0000, label: 0,  bag_size: 18699
batch 19, cls loss: 0.0000, label: 0,  bag_size: 21450
batch 24, cls loss: 0.0000, label: 2,  bag_size: 1216
batch 29, cls loss: 0.0000, label: 1,  bag_size: 11743
batch 34, cls loss: 0.0000, label: 0,  bag_size: 3121
batch 39, cls loss: 0.0002, label: 0,  bag_size: 10498
batch 44, cls loss: 0.0057, label: 0,  bag_size: 6731
batch 49, cls loss: 0.0000, label: 0,  bag_size: 9649
batch 54, cls loss: 0.0002, label: 2,  bag_size: 14852
batch 59, cls loss: 0.0000, label: 2,  bag_size: 1628
batch 64, cls loss: 0.0000, label: 2,  bag_size: 1330
batch 69, cls loss: 0.0000, label: 0,  bag_size: 15563
batch 74, cls loss: 0.0010, label: 1,  bag_size: 9123
batch 79, cls loss: 0.0000, label: 0,  bag_size: 22286
batch 84, cls loss: 0.0002, label: 2,  bag_size: 15321
batch 89, cls loss: 0.0000, label: 2,  bag_size: 8866
batch 94, cls loss: 0.0037, label: 1,  bag_size: 3149
batch 99, cls loss: 0.0000, label: 1,  bag_size: 7781
batch 104, cls loss: 0.0000, label: 2,  bag_size: 1761
batch 109, cls loss: 0.0000, label: 0,  bag_size: 11981
batch 114, cls loss: 0.0000, label: 0,  bag_size: 10592
batch 119, cls loss: 0.0002, label: 0,  bag_size: 1444
batch 124, cls loss: 0.0000, label: 0,  bag_size: 1622
batch 129, cls loss: 0.0000, label: 1,  bag_size: 3359
batch 134, cls loss: 0.0000, label: 2,  bag_size: 11212
batch 139, cls loss: 0.0147, label: 2,  bag_size: 4880
batch 144, cls loss: 0.0000, label: 0,  bag_size: 9065
batch 149, cls loss: 0.0000, label: 0,  bag_size: 7794
batch 154, cls loss: 0.0000, label: 2,  bag_size: 2243
batch 159, cls loss: 0.0002, label: 0,  bag_size: 2395
batch 164, cls loss: 0.0002, label: 0,  bag_size: 5690
batch 169, cls loss: 0.0012, label: 0,  bag_size: 3801
batch 174, cls loss: 0.0009, label: 2,  bag_size: 5597
batch 179, cls loss: 0.0000, label: 0,  bag_size: 9759
batch 184, cls loss: 0.0000, label: 1,  bag_size: 7082
batch 189, cls loss: 0.0000, label: 0,  bag_size: 16379
batch 194, cls loss: 0.0000, label: 2,  bag_size: 7533
batch 199, cls loss: 0.0000, label: 2,  bag_size: 10403
batch 204, cls loss: 0.0000, label: 0,  bag_size: 4807
batch 209, cls loss: 0.0005, label: 0,  bag_size: 4956
batch 214, cls loss: 0.0004, label: 0,  bag_size: 1064
batch 219, cls loss: 0.0000, label: 2,  bag_size: 2278
batch 224, cls loss: 0.0000, label: 0,  bag_size: 4209
batch 229, cls loss: 0.0000, label: 0,  bag_size: 7371
batch 234, cls loss: 0.0000, label: 1,  bag_size: 3701
batch 239, cls loss: 0.0001, label: 0,  bag_size: 1867
batch 244, cls loss: 0.0000, label: 0,  bag_size: 8040
batch 249, cls loss: 0.0000, label: 1,  bag_size: 3338
batch 254, cls loss: 0.0000, label: 0,  bag_size: 645
batch 259, cls loss: 0.0000, label: 2,  bag_size: 6810
batch 264, cls loss: 0.0003, label: 0,  bag_size: 19866
batch 269, cls loss: 0.0000, label: 2,  bag_size: 11891
batch 274, cls loss: 0.0000, label: 0,  bag_size: 7613
batch 279, cls loss: 0.0000, label: 0,  bag_size: 3409
batch 284, cls loss: 0.0000, label: 0,  bag_size: 19832
batch 289, cls loss: 0.0000, label: 0,  bag_size: 5612
batch 294, cls loss: 0.0000, label: 0,  bag_size: 2140
batch 299, cls loss: 0.0000, label: 0,  bag_size: 5563
batch 304, cls loss: 0.0000, label: 0,  bag_size: 6269
batch 309, cls loss: 0.0000, label: 2,  bag_size: 9967
batch 314, cls loss: 0.0004, label: 0,  bag_size: 3640
batch 319, cls loss: 0.0002, label: 0,  bag_size: 4367
batch 324, cls loss: 0.0005, label: 0,  bag_size: 15093
batch 329, cls loss: 0.0000, label: 2,  bag_size: 3229
batch 334, cls loss: 0.0079, label: 0,  bag_size: 2955
batch 339, cls loss: 0.0000, label: 1,  bag_size: 12274
batch 344, cls loss: 0.0000, label: 1,  bag_size: 9121
batch 349, cls loss: 0.3071, label: 0,  bag_size: 4821
batch 354, cls loss: 0.2086, label: 0,  bag_size: 1609
batch 359, cls loss: 0.0000, label: 2,  bag_size: 4442
batch 364, cls loss: 0.0000, label: 2,  bag_size: 3593
batch 369, cls loss: 0.0000, label: 2,  bag_size: 17265
batch 374, cls loss: 0.0013, label: 1,  bag_size: 1654
batch 379, cls loss: 0.1464, label: 0,  bag_size: 9587
batch 384, cls loss: 0.0000, label: 0,  bag_size: 10105
batch 389, cls loss: 0.0000, label: 0,  bag_size: 10920
batch 394, cls loss: 0.4898, label: 2,  bag_size: 6276
batch 399, cls loss: 0.0157, label: 0,  bag_size: 25831
batch 404, cls loss: 0.0000, label: 2,  bag_size: 2629
batch 409, cls loss: 0.0061, label: 0,  bag_size: 17579
batch 414, cls loss: 0.0552, label: 2,  bag_size: 4823
batch 419, cls loss: 0.0000, label: 2,  bag_size: 7060
batch 424, cls loss: 1.4823, label: 1,  bag_size: 2203
batch 429, cls loss: 0.0001, label: 0,  bag_size: 2966
batch 434, cls loss: 0.0000, label: 2,  bag_size: 5924
batch 439, cls loss: 0.0073, label: 0,  bag_size: 3306
batch 444, cls loss: 0.0000, label: 2,  bag_size: 2078
batch 449, cls loss: 0.0083, label: 0,  bag_size: 1823
batch 454, cls loss: 0.1253, label: 1,  bag_size: 3973
batch 459, cls loss: 0.0000, label: 0,  bag_size: 6927
batch 464, cls loss: 0.0000, label: 2,  bag_size: 7133
batch 469, cls loss: 0.0004, label: 2,  bag_size: 747
batch 474, cls loss: 0.0316, label: 0,  bag_size: 13972
batch 479, cls loss: 0.0002, label: 0,  bag_size: 10460
batch 484, cls loss: 0.0000, label: 0,  bag_size: 689
batch 489, cls loss: 0.0000, label: 2,  bag_size: 11961
batch 494, cls loss: 0.0002, label: 0,  bag_size: 4211
batch 499, cls loss: 0.0283, label: 0,  bag_size: 11566
batch 504, cls loss: 0.1830, label: 1,  bag_size: 1832
batch 509, cls loss: 0.0000, label: 1,  bag_size: 3052
batch 514, cls loss: 0.0781, label: 0,  bag_size: 11256
batch 519, cls loss: 0.0350, label: 0,  bag_size: 6665
batch 524, cls loss: 0.0167, label: 0,  bag_size: 3980
batch 529, cls loss: 0.0000, label: 2,  bag_size: 6653
batch 534, cls loss: 0.0058, label: 1,  bag_size: 5856
batch 539, cls loss: 0.0338, label: 0,  bag_size: 1822
batch 544, cls loss: 0.5892, label: 1,  bag_size: 3525
batch 549, cls loss: 0.6622, label: 2,  bag_size: 6861
batch 554, cls loss: 0.0000, label: 2,  bag_size: 909
batch 559, cls loss: 0.0000, label: 1,  bag_size: 8939
batch 564, cls loss: 0.0000, label: 0,  bag_size: 9878
batch 569, cls loss: 0.0000, label: 0,  bag_size: 9297
batch 574, cls loss: 0.0002, label: 1,  bag_size: 1071
batch 579, cls loss: 0.0000, label: 2,  bag_size: 16275
batch 584, cls loss: 0.0030, label: 0,  bag_size: 10848
batch 589, cls loss: 0.0002, label: 0,  bag_size: 1572
batch 594, cls loss: 0.0000, label: 1,  bag_size: 5526
batch 599, cls loss: 0.0002, label: 0,  bag_size: 12611
batch 604, cls loss: 0.0007, label: 0,  bag_size: 2193
batch 609, cls loss: 0.0093, label: 0,  bag_size: 3818
batch 614, cls loss: 0.0020, label: 0,  bag_size: 11768
batch 619, cls loss: 0.0000, label: 0,  bag_size: 3634
batch 624, cls loss: 0.0002, label: 0,  bag_size: 11220
batch 629, cls loss: 0.2591, label: 0,  bag_size: 4058
batch 634, cls loss: 0.0024, label: 1,  bag_size: 2671
batch 639, cls loss: 0.0000, label: 2,  bag_size: 3042
batch 644, cls loss: 0.0000, label: 2,  bag_size: 19220
batch 649, cls loss: 0.0000, label: 1,  bag_size: 2538
batch 654, cls loss: 0.0001, label: 0,  bag_size: 5561
batch 659, cls loss: 0.0001, label: 0,  bag_size: 6781
batch 664, cls loss: 0.0000, label: 0,  bag_size: 1172
batch 669, cls loss: 0.0001, label: 1,  bag_size: 2856
batch 674, cls loss: 0.1224, label: 1,  bag_size: 6582
batch 679, cls loss: 0.0000, label: 0,  bag_size: 9322
batch 684, cls loss: 0.0001, label: 0,  bag_size: 6171
batch 689, cls loss: 0.0001, label: 1,  bag_size: 1940
batch 694, cls loss: 0.0000, label: 0,  bag_size: 10725
batch 699, cls loss: 0.0000, label: 2,  bag_size: 517
batch 704, cls loss: 0.0360, label: 2,  bag_size: 3902
batch 709, cls loss: 0.0000, label: 2,  bag_size: 14455
batch 714, cls loss: 0.0001, label: 0,  bag_size: 6736
batch 719, cls loss: 0.0000, label: 0,  bag_size: 1101
batch 724, cls loss: 0.0000, label: 0,  bag_size: 12795
batch 729, cls loss: 0.0000, label: 0,  bag_size: 1607
batch 734, cls loss: 0.0000, label: 0,  bag_size: 11729
batch 739, cls loss: 0.0000, label: 2,  bag_size: 3755
batch 744, cls loss: 0.0000, label: 0,  bag_size: 4308
batch 749, cls loss: 0.0011, label: 0,  bag_size: 629
batch 754, cls loss: 0.0001, label: 0,  bag_size: 3540
batch 759, cls loss: 0.0007, label: 1,  bag_size: 2015
batch 764, cls loss: 0.0008, label: 0,  bag_size: 2140
batch 769, cls loss: 0.0000, label: 0,  bag_size: 7650
batch 774, cls loss: 0.0000, label: 0,  bag_size: 13362
batch 779, cls loss: 0.0001, label: 0,  bag_size: 13692
batch 784, cls loss: 0.0000, label: 2,  bag_size: 14711
batch 789, cls loss: 0.0809, label: 0,  bag_size: 3879
batch 794, cls loss: 0.0000, label: 0,  bag_size: 5049
batch 799, cls loss: 0.0000, label: 1,  bag_size: 1612
batch 804, cls loss: 0.0005, label: 1,  bag_size: 17508
batch 809, cls loss: 0.0000, label: 2,  bag_size: 6046
batch 814, cls loss: 0.0000, label: 0,  bag_size: 28527
batch 819, cls loss: 0.0001, label: 0,  bag_size: 9321
batch 824, cls loss: 0.5170, label: 1,  bag_size: 3461
batch 829, cls loss: 0.0000, label: 1,  bag_size: 7646
batch 834, cls loss: 0.0001, label: 0,  bag_size: 8856
batch 839, cls loss: 0.0000, label: 2,  bag_size: 2825
batch 844, cls loss: 0.0000, label: 2,  bag_size: 2065
batch 849, cls loss: 0.0000, label: 1,  bag_size: 6938
batch 854, cls loss: 0.0001, label: 1,  bag_size: 2382
batch 859, cls loss: 0.0000, label: 2,  bag_size: 5756
batch 864, cls loss: 0.0000, label: 0,  bag_size: 18161
batch 869, cls loss: 0.0000, label: 1,  bag_size: 5452
batch 874, cls loss: 0.0059, label: 0,  bag_size: 1743
batch 879, cls loss: 0.0000, label: 2,  bag_size: 3171
batch 884, cls loss: 0.0000, label: 0,  bag_size: 4423
batch 889, cls loss: 0.0000, label: 2,  bag_size: 6439
batch 894, cls loss: 0.0000, label: 0,  bag_size: 2405
batch 899, cls loss: 0.0066, label: 2,  bag_size: 991
batch 904, cls loss: 0.0000, label: 1,  bag_size: 2403
batch 909, cls loss: 0.0000, label: 2,  bag_size: 2384
batch 914, cls loss: 0.0000, label: 2,  bag_size: 3332
batch 919, cls loss: 0.0000, label: 1,  bag_size: 26865
batch 924, cls loss: 0.0023, label: 0,  bag_size: 4959
batch 929, cls loss: 0.0000, label: 0,  bag_size: 1014
batch 934, cls loss: 0.0125, label: 0,  bag_size: 19470
batch 939, cls loss: 0.0000, label: 2,  bag_size: 3557
batch 944, cls loss: 0.0001, label: 0,  bag_size: 14897
batch 949, cls loss: 0.0005, label: 0,  bag_size: 16417
batch 954, cls loss: 0.0000, label: 1,  bag_size: 1612
batch 959, cls loss: 0.0000, label: 2,  bag_size: 3585
batch 964, cls loss: 0.0000, label: 2,  bag_size: 6879
batch 969, cls loss: 0.0000, label: 1,  bag_size: 2116
batch 974, cls loss: 0.0001, label: 2,  bag_size: 1356
batch 979, cls loss: 0.0000, label: 0,  bag_size: 6164
batch 984, cls loss: 0.2925, label: 2,  bag_size: 487
batch 989, cls loss: 3.9328, label: 0,  bag_size: 1786
batch 994, cls loss: 0.0008, label: 2,  bag_size: 4583
batch 999, cls loss: 0.0001, label: 0,  bag_size: 1123
batch 1004, cls loss: 0.0000, label: 1,  bag_size: 11017
batch 1009, cls loss: 0.0550, label: 0,  bag_size: 8264
batch 1014, cls loss: 0.0000, label: 0,  bag_size: 6966
batch 1019, cls loss: 0.0000, label: 0,  bag_size: 10072
batch 1024, cls loss: 0.0000, label: 0,  bag_size: 15665
batch 1029, cls loss: 0.0007, label: 1,  bag_size: 6176
batch 1034, cls loss: 0.0000, label: 2,  bag_size: 1681
batch 1039, cls loss: 0.1727, label: 1,  bag_size: 1863
batch 1044, cls loss: 0.0093, label: 0,  bag_size: 21252
batch 1049, cls loss: 0.0010, label: 0,  bag_size: 8592
batch 1054, cls loss: 0.0375, label: 0,  bag_size: 11964
batch 1059, cls loss: 0.0002, label: 0,  bag_size: 12394
batch 1064, cls loss: 0.0000, label: 2,  bag_size: 1505
batch 1069, cls loss: 0.0021, label: 0,  bag_size: 15192
batch 1074, cls loss: 0.0000, label: 0,  bag_size: 18794
batch 1079, cls loss: 0.0000, label: 2,  bag_size: 4344
batch 1084, cls loss: 0.0000, label: 2,  bag_size: 1381
batch 1089, cls loss: 0.0000, label: 0,  bag_size: 3557
batch 1094, cls loss: 0.0000, label: 2,  bag_size: 6454
batch 1099, cls loss: 0.0001, label: 0,  bag_size: 1230
batch 1104, cls loss: 0.0001, label: 0,  bag_size: 15185
batch 1109, cls loss: 0.0864, label: 2,  bag_size: 1447
batch 1114, cls loss: 0.0000, label: 2,  bag_size: 6027
batch 1119, cls loss: 0.0865, label: 1,  bag_size: 7608
batch 1124, cls loss: 0.0013, label: 0,  bag_size: 1657
batch 1129, cls loss: 0.0000, label: 2,  bag_size: 6328
batch 1134, cls loss: 0.0000, label: 2,  bag_size: 3064
batch 1139, cls loss: 0.0000, label: 2,  bag_size: 3957
batch 1144, cls loss: 0.1389, label: 0,  bag_size: 3334
batch 1149, cls loss: 0.0000, label: 2,  bag_size: 1790
batch 1154, cls loss: 0.0057, label: 0,  bag_size: 6682
batch 1159, cls loss: 0.0000, label: 1,  bag_size: 9663
batch 1164, cls loss: 0.0000, label: 1,  bag_size: 1874
batch 1169, cls loss: 0.0000, label: 2,  bag_size: 10866
batch 1174, cls loss: 0.0000, label: 2,  bag_size: 1690
batch 1179, cls loss: 0.0017, label: 1,  bag_size: 9600
batch 1184, cls loss: 0.0138, label: 1,  bag_size: 834
batch 1189, cls loss: 0.0002, label: 1,  bag_size: 1116
batch 1194, cls loss: 0.0000, label: 2,  bag_size: 6590
batch 1199, cls loss: 0.0000, label: 0,  bag_size: 3211
batch 1204, cls loss: 0.0000, label: 0,  bag_size: 5256
batch 1209, cls loss: 0.0006, label: 0,  bag_size: 4375
batch 1214, cls loss: 0.0008, label: 0,  bag_size: 18468
batch 1219, cls loss: 0.0003, label: 2,  bag_size: 1023
batch 1224, cls loss: 0.0298, label: 1,  bag_size: 1796
batch 1229, cls loss: 0.0004, label: 1,  bag_size: 4872
batch 1234, cls loss: 0.0017, label: 0,  bag_size: 1493
batch 1239, cls loss: 0.0000, label: 0,  bag_size: 7768
batch 1244, cls loss: 0.0000, label: 2,  bag_size: 1852
batch 1249, cls loss: 0.0000, label: 2,  bag_size: 6793
batch 1254, cls loss: 0.0001, label: 0,  bag_size: 13786
batch 1259, cls loss: 0.0054, label: 0,  bag_size: 6726
batch 1264, cls loss: 0.0010, label: 0,  bag_size: 20354
batch 1269, cls loss: 0.0000, label: 1,  bag_size: 2552
batch 1274, cls loss: 0.0000, label: 1,  bag_size: 876
batch 1279, cls loss: 0.0635, label: 0,  bag_size: 4201
batch 1284, cls loss: 0.0006, label: 1,  bag_size: 3263
batch 1289, cls loss: 0.0000, label: 2,  bag_size: 7071
batch 1294, cls loss: 0.0000, label: 0,  bag_size: 1294
batch 1299, cls loss: 0.0000, label: 0,  bag_size: 2996
batch 1304, cls loss: 0.0000, label: 2,  bag_size: 5497
batch 1309, cls loss: 0.0001, label: 0,  bag_size: 2480
Epoch: 85, cls train_loss: 0.0448, cls train_error: 0.0145
class 0: tpr 0.9902912621359223, correct 612/618
class 1: tpr 0.9766536964980544, correct 251/257
class 2: tpr 0.9840546697038725, correct 432/439

Val Set, cls val_loss: 0.2716, cls val_error: 0.0196, cls auc: 0.9920
class 0: tpr 0.95, correct 19/20
class 1: tpr 1.0, correct 9/9
class 2: tpr 1.0, correct 22/22
EarlyStopping counter: 19 out of 20


batch 4, cls loss: 0.0000, label: 2,  bag_size: 4940
batch 9, cls loss: 0.0000, label: 2,  bag_size: 3988
batch 14, cls loss: 0.0005, label: 0,  bag_size: 3549
batch 19, cls loss: 0.0012, label: 1,  bag_size: 10178
batch 24, cls loss: 0.5851, label: 2,  bag_size: 9233
batch 29, cls loss: 0.0000, label: 0,  bag_size: 9330
batch 34, cls loss: 0.0003, label: 0,  bag_size: 10432
batch 39, cls loss: 0.0005, label: 1,  bag_size: 3509
batch 44, cls loss: 0.0000, label: 2,  bag_size: 6328
batch 49, cls loss: 0.8628, label: 0,  bag_size: 1512
batch 54, cls loss: 0.0015, label: 1,  bag_size: 3425
batch 59, cls loss: 0.0000, label: 2,  bag_size: 2876
batch 64, cls loss: 0.0000, label: 2,  bag_size: 4125
batch 69, cls loss: 0.0025, label: 2,  bag_size: 3261
batch 74, cls loss: 1.2867, label: 2,  bag_size: 5353
batch 79, cls loss: 0.0000, label: 0,  bag_size: 7515
batch 84, cls loss: 0.0000, label: 1,  bag_size: 1147
batch 89, cls loss: 0.4899, label: 0,  bag_size: 5647
batch 94, cls loss: 0.0228, label: 2,  bag_size: 7216
batch 99, cls loss: 0.0000, label: 0,  bag_size: 14155
batch 104, cls loss: 0.0180, label: 0,  bag_size: 6533
batch 109, cls loss: 0.0000, label: 1,  bag_size: 4471
batch 114, cls loss: 0.0002, label: 0,  bag_size: 11195
batch 119, cls loss: 0.0000, label: 0,  bag_size: 7110
batch 124, cls loss: 0.0000, label: 0,  bag_size: 9913
batch 129, cls loss: 0.0000, label: 0,  bag_size: 9877
batch 134, cls loss: 0.0000, label: 0,  bag_size: 689
batch 139, cls loss: 0.0000, label: 0,  bag_size: 2798
batch 144, cls loss: 0.0000, label: 2,  bag_size: 10698
batch 149, cls loss: 0.0004, label: 0,  bag_size: 3651
batch 154, cls loss: 0.0000, label: 0,  bag_size: 6016
batch 159, cls loss: 0.0001, label: 0,  bag_size: 16565
batch 164, cls loss: 0.0000, label: 1,  bag_size: 3218
batch 169, cls loss: 0.0000, label: 0,  bag_size: 18794
batch 174, cls loss: 0.0000, label: 0,  bag_size: 8522
batch 179, cls loss: 0.0004, label: 1,  bag_size: 2511
batch 184, cls loss: 0.0000, label: 0,  bag_size: 5155
batch 189, cls loss: 0.0000, label: 0,  bag_size: 16512
batch 194, cls loss: 0.0000, label: 2,  bag_size: 2104
batch 199, cls loss: 0.0000, label: 2,  bag_size: 6522
batch 204, cls loss: 0.0001, label: 0,  bag_size: 4956
batch 209, cls loss: 0.2925, label: 0,  bag_size: 19439
batch 214, cls loss: 0.0000, label: 0,  bag_size: 3368
batch 219, cls loss: 0.0000, label: 2,  bag_size: 2243
batch 224, cls loss: 0.0003, label: 1,  bag_size: 5791
batch 229, cls loss: 0.0000, label: 0,  bag_size: 9004
batch 234, cls loss: 0.0000, label: 1,  bag_size: 9032
batch 239, cls loss: 0.0001, label: 1,  bag_size: 618
batch 244, cls loss: 0.0000, label: 1,  bag_size: 5727
batch 249, cls loss: 0.0003, label: 0,  bag_size: 8012
batch 254, cls loss: 0.0003, label: 0,  bag_size: 18988
batch 259, cls loss: 0.0000, label: 2,  bag_size: 4270
batch 264, cls loss: 0.0000, label: 1,  bag_size: 5726
batch 269, cls loss: 0.0000, label: 0,  bag_size: 4715
batch 274, cls loss: 0.1121, label: 0,  bag_size: 9404
batch 279, cls loss: 0.0001, label: 0,  bag_size: 6171
batch 284, cls loss: 0.0024, label: 2,  bag_size: 1202
batch 289, cls loss: 1.5015, label: 2,  bag_size: 9412
batch 294, cls loss: 0.0652, label: 1,  bag_size: 3009
batch 299, cls loss: 0.0000, label: 0,  bag_size: 9258
batch 304, cls loss: 0.0000, label: 2,  bag_size: 2496
batch 309, cls loss: 0.4583, label: 1,  bag_size: 1138
batch 314, cls loss: 0.0000, label: 2,  bag_size: 3956
batch 319, cls loss: 0.0000, label: 2,  bag_size: 4227
batch 324, cls loss: 0.0000, label: 2,  bag_size: 3787
batch 329, cls loss: 0.0039, label: 2,  bag_size: 9154
batch 334, cls loss: 0.0044, label: 2,  bag_size: 17087
batch 339, cls loss: 0.0000, label: 0,  bag_size: 3211
batch 344, cls loss: 0.0001, label: 2,  bag_size: 4344
batch 349, cls loss: 0.0000, label: 2,  bag_size: 17265
batch 354, cls loss: 0.0000, label: 2,  bag_size: 7523
batch 359, cls loss: 0.0557, label: 1,  bag_size: 2671
batch 364, cls loss: 0.0000, label: 0,  bag_size: 10028
batch 369, cls loss: 0.0000, label: 1,  bag_size: 1960
batch 374, cls loss: 0.0000, label: 0,  bag_size: 8191
batch 379, cls loss: 0.0060, label: 1,  bag_size: 7168
batch 384, cls loss: 0.0007, label: 0,  bag_size: 14538
batch 389, cls loss: 0.0000, label: 0,  bag_size: 6781
batch 394, cls loss: 0.0000, label: 2,  bag_size: 10298
batch 399, cls loss: 1.7306, label: 1,  bag_size: 13121
batch 404, cls loss: 0.0000, label: 0,  bag_size: 7381
batch 409, cls loss: 0.0000, label: 2,  bag_size: 11901
batch 414, cls loss: 0.0480, label: 0,  bag_size: 3176
batch 419, cls loss: 0.2704, label: 0,  bag_size: 4128
batch 424, cls loss: 0.0001, label: 0,  bag_size: 6792
batch 429, cls loss: 0.0000, label: 0,  bag_size: 20882
batch 434, cls loss: 0.0000, label: 0,  bag_size: 1572
batch 439, cls loss: 0.0001, label: 0,  bag_size: 1845
batch 444, cls loss: 0.0000, label: 0,  bag_size: 9478
batch 449, cls loss: 0.0000, label: 0,  bag_size: 5723
batch 454, cls loss: 0.0013, label: 2,  bag_size: 8383
batch 459, cls loss: 0.0000, label: 0,  bag_size: 13367
batch 464, cls loss: 0.0000, label: 0,  bag_size: 9162
batch 469, cls loss: 0.0000, label: 0,  bag_size: 11421
batch 474, cls loss: 0.0000, label: 2,  bag_size: 6276
batch 479, cls loss: 0.0000, label: 0,  bag_size: 13440
batch 484, cls loss: 0.0000, label: 0,  bag_size: 13947
batch 489, cls loss: 0.0005, label: 0,  bag_size: 6825
batch 494, cls loss: 0.0000, label: 0,  bag_size: 3856
batch 499, cls loss: 0.0000, label: 2,  bag_size: 5756
batch 504, cls loss: 0.0000, label: 2,  bag_size: 3279
batch 509, cls loss: 0.0000, label: 0,  bag_size: 4250
batch 514, cls loss: 0.0000, label: 0,  bag_size: 6769
batch 519, cls loss: 0.0017, label: 0,  bag_size: 9610
batch 524, cls loss: 0.0060, label: 2,  bag_size: 2932
batch 529, cls loss: 0.0007, label: 2,  bag_size: 25160
batch 534, cls loss: 0.0000, label: 0,  bag_size: 5695
batch 539, cls loss: 0.0000, label: 2,  bag_size: 2755
batch 544, cls loss: 0.0001, label: 2,  bag_size: 5808
batch 549, cls loss: 0.0000, label: 2,  bag_size: 3203
batch 554, cls loss: 0.0016, label: 0,  bag_size: 5612
batch 559, cls loss: 0.0000, label: 0,  bag_size: 13051
batch 564, cls loss: 0.0000, label: 2,  bag_size: 3064
batch 569, cls loss: 0.0000, label: 1,  bag_size: 11063
batch 574, cls loss: 0.0007, label: 0,  bag_size: 12719
batch 579, cls loss: 0.0000, label: 0,  bag_size: 5516
batch 584, cls loss: 0.0021, label: 1,  bag_size: 4526
batch 589, cls loss: 0.0000, label: 2,  bag_size: 3146
batch 594, cls loss: 0.0000, label: 0,  bag_size: 21450
batch 599, cls loss: 0.0006, label: 0,  bag_size: 1764
batch 604, cls loss: 0.0000, label: 2,  bag_size: 2676
batch 609, cls loss: 0.0000, label: 0,  bag_size: 13861
batch 614, cls loss: 0.0000, label: 0,  bag_size: 5256
batch 619, cls loss: 0.0001, label: 2,  bag_size: 4583
batch 624, cls loss: 0.0000, label: 1,  bag_size: 5459
batch 629, cls loss: 0.0000, label: 1,  bag_size: 6498
batch 634, cls loss: 0.0386, label: 1,  bag_size: 13919
batch 639, cls loss: 0.0000, label: 2,  bag_size: 8194
batch 644, cls loss: 0.0001, label: 0,  bag_size: 13089
batch 649, cls loss: 0.0000, label: 2,  bag_size: 11815
batch 654, cls loss: 0.0009, label: 0,  bag_size: 2215
batch 659, cls loss: 0.0000, label: 0,  bag_size: 3295
batch 664, cls loss: 0.0000, label: 2,  bag_size: 7774
batch 669, cls loss: 0.0000, label: 0,  bag_size: 9673
batch 674, cls loss: 0.0000, label: 1,  bag_size: 9663
batch 679, cls loss: 0.0000, label: 0,  bag_size: 3224
batch 684, cls loss: 0.0006, label: 2,  bag_size: 6319
batch 689, cls loss: 0.0086, label: 1,  bag_size: 6448
batch 694, cls loss: 0.0268, label: 2,  bag_size: 2542
batch 699, cls loss: 0.0000, label: 1,  bag_size: 1082
batch 704, cls loss: 0.0159, label: 2,  bag_size: 2770
batch 709, cls loss: 0.0000, label: 2,  bag_size: 1216
batch 714, cls loss: 0.0000, label: 0,  bag_size: 15332
batch 719, cls loss: 0.0000, label: 0,  bag_size: 3937
batch 724, cls loss: 0.0000, label: 1,  bag_size: 3741
batch 729, cls loss: 0.0001, label: 0,  bag_size: 1743
batch 734, cls loss: 0.0000, label: 0,  bag_size: 15093
batch 739, cls loss: 0.0000, label: 1,  bag_size: 9173
batch 744, cls loss: 0.0000, label: 0,  bag_size: 9747
batch 749, cls loss: 0.0000, label: 2,  bag_size: 3097
batch 754, cls loss: 0.0000, label: 2,  bag_size: 7519
batch 759, cls loss: 0.0060, label: 2,  bag_size: 5021
batch 764, cls loss: 0.0000, label: 0,  bag_size: 7424
batch 769, cls loss: 0.0000, label: 0,  bag_size: 8602
batch 774, cls loss: 0.0000, label: 2,  bag_size: 704
batch 779, cls loss: 0.0000, label: 2,  bag_size: 5050
batch 784, cls loss: 0.0000, label: 2,  bag_size: 5290
batch 789, cls loss: 0.0000, label: 1,  bag_size: 1368
batch 794, cls loss: 0.0003, label: 0,  bag_size: 1746
batch 799, cls loss: 0.0000, label: 0,  bag_size: 4188
batch 804, cls loss: 0.0000, label: 2,  bag_size: 3086
batch 809, cls loss: 0.0005, label: 0,  bag_size: 7989
batch 814, cls loss: 0.0000, label: 0,  bag_size: 18649
batch 819, cls loss: 0.0000, label: 2,  bag_size: 9575
batch 824, cls loss: 0.0000, label: 0,  bag_size: 19500
batch 829, cls loss: 0.0000, label: 0,  bag_size: 7613
batch 834, cls loss: 0.0004, label: 1,  bag_size: 1772
batch 839, cls loss: 0.0000, label: 1,  bag_size: 7648
batch 844, cls loss: 0.0000, label: 0,  bag_size: 5110
batch 849, cls loss: 0.0001, label: 0,  bag_size: 11389
batch 854, cls loss: 0.0000, label: 0,  bag_size: 30675
batch 859, cls loss: 0.0000, label: 2,  bag_size: 9756
batch 864, cls loss: 0.0031, label: 0,  bag_size: 5690
batch 869, cls loss: 0.0000, label: 0,  bag_size: 13732
batch 874, cls loss: 0.0000, label: 2,  bag_size: 1763
batch 879, cls loss: 0.0000, label: 1,  bag_size: 803
batch 884, cls loss: 0.0000, label: 2,  bag_size: 2759
batch 889, cls loss: 0.0000, label: 1,  bag_size: 11756
batch 894, cls loss: 0.0000, label: 2,  bag_size: 9103
batch 899, cls loss: 0.0000, label: 2,  bag_size: 1505
batch 904, cls loss: 0.0000, label: 2,  bag_size: 14572
batch 909, cls loss: 0.0000, label: 2,  bag_size: 3229
batch 914, cls loss: 0.0002, label: 2,  bag_size: 6981
batch 919, cls loss: 0.0000, label: 0,  bag_size: 14681
batch 924, cls loss: 0.0000, label: 0,  bag_size: 4084
batch 929, cls loss: 0.0000, label: 0,  bag_size: 3409
batch 934, cls loss: 0.0000, label: 0,  bag_size: 5494
batch 939, cls loss: 0.0000, label: 0,  bag_size: 9955
batch 944, cls loss: 0.0000, label: 0,  bag_size: 13786
batch 949, cls loss: 0.1501, label: 2,  bag_size: 2686
batch 954, cls loss: 0.0216, label: 2,  bag_size: 2232
batch 959, cls loss: 0.0001, label: 0,  bag_size: 3640
batch 964, cls loss: 0.0000, label: 1,  bag_size: 876
batch 969, cls loss: 0.0009, label: 0,  bag_size: 6726
batch 974, cls loss: 0.0000, label: 0,  bag_size: 10591
batch 979, cls loss: 0.0000, label: 2,  bag_size: 1035
batch 984, cls loss: 0.0000, label: 2,  bag_size: 1552
batch 989, cls loss: 0.0000, label: 2,  bag_size: 6476
batch 994, cls loss: 0.0001, label: 2,  bag_size: 6371
batch 999, cls loss: 0.0081, label: 0,  bag_size: 10438
batch 1004, cls loss: 0.0000, label: 1,  bag_size: 3916
batch 1009, cls loss: 0.0000, label: 0,  bag_size: 13362
batch 1014, cls loss: 0.0042, label: 0,  bag_size: 12494
batch 1019, cls loss: 0.0000, label: 0,  bag_size: 17880
batch 1024, cls loss: 0.0013, label: 1,  bag_size: 1832
batch 1029, cls loss: 0.0015, label: 1,  bag_size: 8254
batch 1034, cls loss: 0.0001, label: 0,  bag_size: 1022
batch 1039, cls loss: 0.0004, label: 1,  bag_size: 1384
batch 1044, cls loss: 0.0000, label: 2,  bag_size: 14455
batch 1049, cls loss: 0.0000, label: 1,  bag_size: 7837
batch 1054, cls loss: 0.0000, label: 0,  bag_size: 8856
batch 1059, cls loss: 0.0000, label: 0,  bag_size: 549
batch 1064, cls loss: 0.0125, label: 2,  bag_size: 4823
batch 1069, cls loss: 0.0000, label: 1,  bag_size: 966
batch 1074, cls loss: 0.0000, label: 2,  bag_size: 4167
batch 1079, cls loss: 0.0000, label: 2,  bag_size: 1479
batch 1084, cls loss: 0.0001, label: 0,  bag_size: 6090
batch 1089, cls loss: 0.0000, label: 0,  bag_size: 10920
batch 1094, cls loss: 0.0050, label: 0,  bag_size: 4822
batch 1099, cls loss: 0.0000, label: 0,  bag_size: 6950
batch 1104, cls loss: 0.0001, label: 0,  bag_size: 9983
batch 1109, cls loss: 0.0000, label: 2,  bag_size: 5658
batch 1114, cls loss: 0.0043, label: 0,  bag_size: 2179
batch 1119, cls loss: 0.0000, label: 2,  bag_size: 2335
batch 1124, cls loss: 0.0000, label: 2,  bag_size: 4189
batch 1129, cls loss: 0.0526, label: 2,  bag_size: 8185
batch 1134, cls loss: 0.0019, label: 0,  bag_size: 1230
batch 1139, cls loss: 0.0000, label: 0,  bag_size: 11684
batch 1144, cls loss: 0.0001, label: 1,  bag_size: 5866
batch 1149, cls loss: 0.0000, label: 0,  bag_size: 19972
batch 1154, cls loss: 0.0000, label: 1,  bag_size: 4620
batch 1159, cls loss: 0.0000, label: 2,  bag_size: 2593
batch 1164, cls loss: 0.1074, label: 0,  bag_size: 1428
batch 1169, cls loss: 0.0000, label: 0,  bag_size: 14887
batch 1174, cls loss: 0.0001, label: 0,  bag_size: 7767
batch 1179, cls loss: 0.0000, label: 0,  bag_size: 699
batch 1184, cls loss: 0.0000, label: 1,  bag_size: 7163
batch 1189, cls loss: 0.0000, label: 0,  bag_size: 17769
batch 1194, cls loss: 0.0004, label: 2,  bag_size: 9255
batch 1199, cls loss: 0.0000, label: 0,  bag_size: 10966
batch 1204, cls loss: 0.0000, label: 1,  bag_size: 10670
batch 1209, cls loss: 0.0000, label: 1,  bag_size: 3194
batch 1214, cls loss: 0.0246, label: 0,  bag_size: 11160
batch 1219, cls loss: 0.0000, label: 2,  bag_size: 2000
batch 1224, cls loss: 0.0000, label: 0,  bag_size: 8868
batch 1229, cls loss: 0.0001, label: 0,  bag_size: 10492
batch 1234, cls loss: 0.0000, label: 2,  bag_size: 21007
batch 1239, cls loss: 0.0000, label: 2,  bag_size: 1850
batch 1244, cls loss: 0.0000, label: 1,  bag_size: 7646
batch 1249, cls loss: 0.0169, label: 2,  bag_size: 1649
batch 1254, cls loss: 0.0000, label: 2,  bag_size: 1690
batch 1259, cls loss: 0.0000, label: 0,  bag_size: 10400
batch 1264, cls loss: 0.0000, label: 2,  bag_size: 11693
batch 1269, cls loss: 0.0214, label: 1,  bag_size: 4629
batch 1274, cls loss: 0.0011, label: 1,  bag_size: 7608
batch 1279, cls loss: 0.0003, label: 1,  bag_size: 9600
batch 1284, cls loss: 0.0000, label: 1,  bag_size: 2590
batch 1289, cls loss: 0.0141, label: 1,  bag_size: 2716
batch 1294, cls loss: 0.0000, label: 2,  bag_size: 1728
batch 1299, cls loss: 0.0000, label: 2,  bag_size: 6452
batch 1304, cls loss: 0.0029, label: 0,  bag_size: 2193
batch 1309, cls loss: 0.0000, label: 2,  bag_size: 9967
Epoch: 86, cls train_loss: 0.0286, cls train_error: 0.0114
class 0: tpr 0.9902912621359223, correct 612/618
class 1: tpr 0.9883268482490273, correct 254/257
class 2: tpr 0.9863325740318907, correct 433/439

Val Set, cls val_loss: 0.4704, cls val_error: 0.0588, cls auc: 0.9859
class 0: tpr 0.9, correct 18/20
class 1: tpr 0.8888888888888888, correct 8/9
class 2: tpr 1.0, correct 22/22
EarlyStopping counter: 20 out of 20
Early stopping
Cls Val error: 0.0392, Cls ROC AUC: 0.9984
Cls Test error: 0.0396, Cls ROC AUC: 0.9935
<utils.core_utils_mtl_concat.Accuracy_Logger object at 0x7f98b56823d0>
finished!
end script

